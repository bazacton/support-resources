import{i as p,s as d,q as n,t as f,m as j,k as g,h as x,j as t,T as o,bF as D,bW as w,B as b,L as v}from"./client-OfhJa1Pp.js";import{g as Q}from"./article-link-xsQ04UkN.js";import{h as l,u as A,a as C}from"./custom-menu-BbwshV9x.js";import{H as I,a as q,b as E,c as H,d as M}from"./hc-manager-title-9uIHtzb_.js";import{m as K}from"./use-sortable-DQoLtUe2.js";import{C as R}from"./confirmation-dialog-BIOq1A-h.js";import"./slugify-string-aubjgLQq.js";import"./breadcrumb-DMWJORWM.js";import"./useEffectEvent-DQn3o5L0.js";import"./ChevronRight-T5gg5A4x.js";import"./MoreHoriz-hMMIYAbm.js";import"./admin-config-tfY5n3F7.js";import"./dashboard-icons-CHop3mns.js";import"./library-icon-CHCHM-UW.js";import"./messages-square-icon-CTmom_u4.js";import"./main-CqFMqK8-.js";import"./Delete-BhyMZiPM.js";import"./Home--R_oEr6a.js";import"./SupervisorAccount-k9OnPB-d.js";import"./Translate-Cs-ut2nW.js";import"./TextFields-8TfbEP0O.js";import"./settings-links-D22SAe6v.js";import"./external-link-DbBk1ItZ.js";import"./book-open-Cbdc52Ur.js";import"./datatable-page-with-header-layout-B1YkbSHJ.js";import"./use-toggle-dashboard-left-sidebar-CnzMOFB9.js";import"./toggle-left-sidebar-icon-Dq5ZwqwZ.js";import"./DragIndicator-BbWWPJ1P.js";import"./MoreVert-Ci70_mZh.js";import"./is-touch-device-C5S2y1Hk.js";import"./OpenInNew-Q67MT6Ae.js";import"./isScrollable-BSEN4xi5.js";import"./use-droppable-DqkAoZym.js";import"./uploaded-file-DN6fXT4v.js";import"./useGlobalListeners-CeWFSHKo.js";function T(){return p({mutationFn:e=>k(e),onSuccess:async()=>{await n.invalidateQueries({queryKey:l.articles.invalidateKey}),f(j("Article deleted"))},onError:e=>d(e)})}function k({ids:e}){return g.delete(`hc/articles/${e.join(",")}`).then(s=>s.data)}const u=e=>l.manager.articles(e).queryKey;function L(){return p({mutationFn:e=>{const s=n.getQueryData(u(e.sectionId)).articles.map(r=>r.id);return S({sectionId:e.sectionId,ids:s})},onMutate:async({oldIndex:e,newIndex:s,sectionId:r})=>{const a=u(r);await n.cancelQueries({queryKey:a});const m=n.getQueryData(a);return n.setQueryData(a,c=>{if(!c)return;const i={...c,articles:c.articles};return i.articles=K(i.articles,e,s),i}),{previousResponse:m}},onSuccess:async()=>{await n.invalidateQueries({queryKey:["articles"]})},onError:(e,s,r)=>{d(e),n.setQueryData(u(s.sectionId),r==null?void 0:r.previousResponse)}})}function S(e){return g.post(`hc/manager/sections/${e.sectionId}/articles/reorder`,e).then(s=>s.data)}function xe(){const e=x(),{sectionId:s}=A(["sectionId"]),r=C(l.manager.articles(s)),a=r.data.articles,m=T(),c=L();return t.jsxs(I,{breadcrumb:t.jsx(M,{category:r.data.category,section:r.data.section}),actionButton:t.jsx(b,{size:"xs",variant:"flat",color:"primary",elementType:v,to:"articles/new",children:t.jsx(o,{message:"New article"})}),children:[a.length?t.jsx(q,{children:t.jsx(o,{message:"Articles (:count)",values:{count:a.length}})}):null,a.map(i=>t.jsx(E,{item:i,items:a,onSortEnd:(y,h)=>{c.mutate({sectionId:s,oldIndex:y,newIndex:h})},onEdit:()=>e(`articles/${i.id}/edit`),onClick:()=>e(`articles/${i.id}/edit`),onView:()=>e(Q(i,{section:r.data.section})),onDelete:()=>{D(R,{title:t.jsx(o,{message:"Delete article"}),body:t.jsx(o,{message:"Are you sure you want to delete this article?"}),confirm:t.jsx(o,{message:"Delete"}),isDanger:!0,isLoading:m.isPending,onConfirm:()=>m.mutate({ids:[i.id]},{onSuccess:()=>w()})})},children:i.title},i.id)),!a.length&&t.jsx(H,{title:t.jsx(o,{message:"This section is empty"}),description:t.jsx(o,{message:"Empty sections aren't visible in the Help Center. You can make them visible by adding an article."})})]})}export{xe as Component};
