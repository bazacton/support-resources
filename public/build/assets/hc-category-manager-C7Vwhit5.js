import{Z as F,j as e,aP as z,F as C,T as o,az as I,e as A,aG as Q,f as R,av as S,bB as U,ae as g,al as u,am as p,an as x,ap as j,aj as K,aR as V,l as $,h as w,i as h,k as y,q as f,t as b,m,a as N,d as D,aq as T,B as l,s as L,bF as v,bW as W}from"./client-OfhJa1Pp.js";import{g as G}from"./category-link-0Q_zOKi3.js";import{H as B,h as O}from"./hc-category-icons-DG0XTX7F.js";import{h as c,o as M,a as E,u as Y}from"./custom-menu-BbwshV9x.js";import{M as Z}from"./managed-by-field-D7JPY3A-.js";import{V as J}from"./visible-to-field-I5OzeH9w.js";import{I as X}from"./image-selector-Bwr5VwEQ.js";import{F as ee}from"./file-upload-provider-DTPBUrkd.js";import{F as se}from"./form-chip-field-sH5S7-lx.js";import{F as te}from"./select-Dsco87dL.js";import{A as ae}from"./AddPhotoAlternate-CfOOrUJU.js";import{H as oe,a as re,d as ie,u as ne,b as ce,c as _}from"./hc-manager-title-9uIHtzb_.js";import{B as me}from"./bullet-seprated-items-Dl11L_1z.js";import{C as le}from"./confirmation-dialog-BIOq1A-h.js";import"./slugify-string-aubjgLQq.js";import"./dashboard-icons-CHop3mns.js";import"./library-icon-CHCHM-UW.js";import"./messages-square-icon-CTmom_u4.js";import"./main-CqFMqK8-.js";import"./Delete-BhyMZiPM.js";import"./Home--R_oEr6a.js";import"./SupervisorAccount-k9OnPB-d.js";import"./book-open-Cbdc52Ur.js";import"./Translate-Cs-ut2nW.js";import"./FileUpload-B22fc7n3.js";import"./Article-Daay8e29.js";import"./Email-BEay9knN.js";import"./Event-7FmyLdJJ.js";import"./Info-tjnOYMTt.js";import"./Schedule-BuWxyNlz.js";import"./TextFields-8TfbEP0O.js";import"./Tune-DusFnn8x.js";import"./use-active-upload-CCDRf1Tl.js";import"./open-upload-window-CSDcieK1.js";import"./uploaded-file-DN6fXT4v.js";import"./shallow-BSWIanyL.js";import"./AddAPhoto-eWqbbo4Z.js";import"./progress-bar-iRLStr1h.js";import"./file-input-config-DrcTpI3-.js";import"./pretty-bytes-bO14ePu9.js";import"./with-selector-CDgEpx5P.js";import"./chip-list-CkGaRoaT.js";import"./combobox-end-adornment-CaH5Sr_u.js";import"./breadcrumb-DMWJORWM.js";import"./useEffectEvent-DQn3o5L0.js";import"./ChevronRight-T5gg5A4x.js";import"./MoreHoriz-hMMIYAbm.js";import"./admin-config-tfY5n3F7.js";import"./settings-links-D22SAe6v.js";import"./external-link-DbBk1ItZ.js";import"./datatable-page-with-header-layout-B1YkbSHJ.js";import"./use-toggle-dashboard-left-sidebar-CnzMOFB9.js";import"./toggle-left-sidebar-icon-Dq5ZwqwZ.js";import"./use-sortable-DQoLtUe2.js";import"./isScrollable-BSEN4xi5.js";import"./use-droppable-DqkAoZym.js";import"./useGlobalListeners-CeWFSHKo.js";import"./DragIndicator-BbWWPJ1P.js";import"./MoreVert-Ci70_mZh.js";import"./is-touch-device-C5S2y1Hk.js";import"./OpenInNew-Q67MT6Ae.js";function H({form:s,onSubmit:r,formId:a,hideParentId:t}){const{data:i}=F(c.categories.normalizedList());return e.jsxs(z,{id:a,form:s,onSubmit:r,children:[e.jsxs("div",{className:"mb-24 flex items-center gap-12",children:[e.jsx(de,{}),e.jsx(C,{name:"name",label:e.jsx(o,{message:"Name"}),className:"flex-auto",required:!0,autoFocus:!0})]}),e.jsx(C,{name:"description",label:e.jsx(o,{message:"Description"}),inputElementType:"textarea",rows:4,className:"mb-24"}),t&&e.jsx(te,{name:"parent_id",selectionMode:"single",label:"Parent category",className:"mb-24",children:i==null?void 0:i.categories.map(n=>e.jsx(I,{value:n.id,children:e.jsx(o,{message:n.name})},n.id))}),e.jsx(J,{className:"mb-24",description:e.jsx(o,{message:"Control who can see this category in help center"})}),e.jsx(Z,{description:e.jsx(o,{message:"Control who can edit this category"}),className:"mb-24"}),e.jsx(ue,{}),e.jsx(A,{name:"hide_from_structure",description:e.jsx(o,{message:"Will hide this category name in the help center and only show it's contents."}),children:e.jsx(o,{message:"Hide from structure"})})]})}function de(){const s=Q({name:"image"}),{setValue:r}=R(),a=s?e.jsx(B,{iconSize:"h-28 w-28",src:s}):e.jsx(ae,{});return e.jsxs("div",{children:[e.jsx("div",{className:"mb-4 text-sm",children:e.jsx(o,{message:"Image"})}),e.jsxs(S,{type:"popover",onClose:t=>{t&&r("image",t,{shouldDirty:!0})},children:[e.jsx(U,{className:"flex h-42 w-42 items-center justify-center rounded-input border hover:bg-hover",children:a}),e.jsx(ge,{selectedImage:s})]})]})}function ge({selectedImage:s}){const{close:r}=u();return e.jsxs(p,{size:"sm",children:[e.jsx(x,{children:e.jsx(o,{message:"Category icon"})}),e.jsxs(j,{children:[e.jsx("section",{className:"mb-44",children:e.jsx("div",{className:"-mx-8 grid grid-cols-8 gap-8",children:Object.entries(O).map(([a,t])=>e.jsx(K,{color:s===a?"primary":void 0,size:"md",onClick:()=>r(a),children:e.jsx(t,{})},a))})}),e.jsxs("section",{children:[e.jsx("div",{className:"mb-12 text-sm font-semibold",children:e.jsx(o,{message:"Upload custom icon"})}),e.jsx(ee,{children:e.jsx(X,{uploadType:V.brandingImages,className:"mb-24",showRemoveButton:!0,onChange:a=>r(a)})})]})]})]})}function ue(){const{data:s}=F($.tags.index()),r=(s==null?void 0:s.tags)||[],{trans:a}=g();return r.length?e.jsx(se,{className:"mb-24",placeholder:a({message:"Add tag..."}),background:"bg",label:e.jsx(o,{message:"Tags"}),name:"tags",chipSize:"sm",suggestions:r,description:e.jsx(o,{message:"Add tags to allow scoping help center content to specific topics."}),children:t=>e.jsx(I,{value:t.name,children:e.jsx(o,{message:t.name})},t.name)}):null}function pe(s){const{trans:r}=g(),a=w();return h({mutationFn:t=>y.post("hc/categories",t).then(i=>i.data),onSuccess:async t=>{await f.invalidateQueries({queryKey:c.manager.invalidateKey}),a(t.category.is_section?`../../sections/${t.category.id}`:`categories/${t.category.id}`,{relative:"path"}),b(r(t.category.is_section?m("Category created"):m("Section created")))},onError:t=>M(t,s)})}function xe(){const{categoryId:s}=N(),{close:r,formId:a}=u(),t=D({defaultValues:{parent_id:s?parseInt(s):void 0,hide_from_structure:!1,visible_to_role:"",managed_by_role:""}}),i=pe(t);return e.jsxs(p,{size:"lg",children:[e.jsx(x,{children:s?e.jsx(o,{message:"Add new section"}):e.jsx(o,{message:"Add new category"})}),e.jsx(j,{children:e.jsx(H,{hideParentId:!!s,formId:a,form:t,onSubmit:n=>{i.mutate(n,{onSuccess:()=>r()})}})}),e.jsxs(T,{children:[e.jsx(l,{onClick:()=>r(),children:e.jsx(o,{message:"Cancel"})}),e.jsx(l,{form:a,disabled:i.isPending,variant:"flat",color:"primary",type:"submit",children:e.jsx(o,{message:"Create"})})]})]})}function je(s){const{trans:r}=g();return h({mutationFn:a=>y.put(`hc/categories/${a.id}`,a).then(t=>t.data),onSuccess:async a=>{await f.invalidateQueries({queryKey:c.manager.invalidateKey}),b(r(a.category.is_section?m("Category updated"):m("Section updated")))},onError:a=>M(a,s)})}function he({item:s}){const{close:r,formId:a}=u(),t=D({defaultValues:{name:s.name,parent_id:s.parent_id,description:s.description,image:s.image,visible_to_role:s.visible_to_role||"",managed_by_role:s.managed_by_role||"",hide_from_structure:s.hide_from_structure,tags:s.tags}}),i=je(t);return e.jsxs(p,{size:"lg",children:[e.jsx(x,{children:s.is_section?e.jsx(o,{message:"Update section"}):e.jsx(o,{message:"Update category"})}),e.jsx(j,{children:e.jsx(H,{hideParentId:s.is_section,formId:a,form:t,onSubmit:n=>{i.mutate({...n,id:s.id},{onSuccess:()=>r()})}})}),e.jsxs(T,{children:[e.jsx(l,{onClick:()=>{r()},children:e.jsx(o,{message:"Cancel"})}),e.jsx(l,{form:a,disabled:i.isPending,variant:"flat",color:"primary",type:"submit",children:e.jsx(o,{message:"Update"})})]})]})}function ye(){return h({mutationFn:({id:s})=>y.delete(`hc/categories/${s}`).then(r=>r.data),onSuccess:async()=>{await f.invalidateQueries({queryKey:c.manager.invalidateKey}),b(m("Category deleted"))},onError:s=>L(s)})}function Ns(){const s=E(c.manager.categories());return e.jsx(P,{type:"categories",data:s.data})}function Ds(){const{categoryId:s}=Y(["categoryId"]),r=E(c.manager.sections(s));return e.jsx(P,{type:"sections",data:r.data})}function P({type:s,data:r}){const a=r.categories,t=a.length;return e.jsxs(oe,{breadcrumb:e.jsx(ie,{category:r.category}),actionButton:e.jsxs(S,{type:"modal",children:[e.jsx(l,{variant:"flat",color:"primary",size:"xs",className:"max-md:mt-12",children:s==="categories"?e.jsx(o,{message:"New category"}):e.jsx(o,{message:"New section"})}),e.jsx(xe,{})]}),children:[t?e.jsx(re,{children:s==="categories"?e.jsx(o,{message:"Categories (:count)",values:{count:t}}):e.jsx(o,{message:"Sections (:count)",values:{count:t}})}):null,a.map(i=>e.jsx(fe,{category:i,data:r},i.id)),!a.length&&e.jsx(be,{})]})}function fe({category:s,data:{categories:r,category:a}}){const t=w(),i=ye(),n=ne(),q=()=>{s.is_section?t(`../sections/${s.id}`):t(`categories/${s.id}`)};return e.jsx(ce,{item:s,items:r,onSortEnd:(d,k)=>{n.mutate({oldIndex:d,newIndex:k,parentId:a==null?void 0:a.id})},onClick:()=>q(),onView:()=>t(G(s)),onEdit:()=>v(he,{item:s}),onDelete:()=>{v(le,{title:e.jsx(o,{message:"Delete category"}),body:e.jsx(o,{message:"Are you sure you want to delete this category?"}),confirm:e.jsx(o,{message:"Delete"}),isDanger:!0,isLoading:i.isPending,onConfirm:()=>i.mutate({id:s.id},{onSuccess:()=>W()})})},description:e.jsxs(me,{children:[s.is_section?null:e.jsx(o,{message:"[one 1 section|other :count sections]",values:{count:s.sections_count}}),e.jsx(o,{message:"[one 1 article|other :count articles]",values:{count:s.articles_count}}),s.tags.length?e.jsx("span",{children:s.tags.map(d=>e.jsx("span",{className:"flex h-16 items-center rounded-full bg-chip px-6 text-xs font-medium",children:d},d))}):null]}),icon:s.image?e.jsx(B,{className:"h-40 w-40 border border-divider-lighter p-4",src:s.image}):null,children:s.name})}function be(){const{categoryId:s}=N();return s?e.jsx(_,{title:e.jsx(o,{message:"This category is empty"}),description:e.jsx(o,{message:"Empty categories aren't visible in the Help Center. You can make them visible by adding a section."})}):e.jsx(_,{title:e.jsx(o,{message:"There are no categories yet"})})}export{Ns as CategoriesManager,Ds as SectionsManager};
