import{m as a,b1 as m,b2 as d,j as e,T as s,aQ as f,as as v,H as D,r as g,av as k,aw as A,aj as S,ax as T,az as u,L as y,al as C,t as b,i as P,s as w,k as I,q as F,l as h,h as O,aZ as q}from"./client-OfhJa1Pp.js";import{A as N}from"./admin-config-tfY5n3F7.js";import{i as E,j as H,h as L}from"./main-CqFMqK8-.js";import{D as M}from"./settings-links-D22SAe6v.js";import{G as B}from"./global-loading-progress-CKXIm6JS.js";import{D as V}from"./data-table-add-item-button-2jwTYQ5G.js";import{D as U}from"./data-table-header-CeAVoFvI.js";import{D as Q}from"./data-table-pagination-footer-CEEx1VtI.js";import{u as W}from"./use-datatable-search-params-CQGreY35.js";import{D as Z}from"./data-table-emty-state-message-DLsG3g03.js";import{D as $}from"./datatable-filters-C2DdpqvR.js";import{a as z,D as R,b as _,c as G}from"./datatable-page-with-header-layout-B1YkbSHJ.js";import{u as K}from"./use-datatable-query-BQ-GXlzU.js";import{T as J}from"./table-BifRiqkr.js";import{u as X}from"./use-update-attribute-C3XDTavQ.js";import{P as Y}from"./pretty-attribute-type-CZh-32ZO.js";import{M as ee}from"./MoreVert-Ci70_mZh.js";import{C as te}from"./confirmation-dialog-BIOq1A-h.js";import"./dashboard-icons-CHop3mns.js";import"./library-icon-CHCHM-UW.js";import"./messages-square-icon-CTmom_u4.js";import"./Delete-BhyMZiPM.js";import"./Home--R_oEr6a.js";import"./SupervisorAccount-k9OnPB-d.js";import"./Translate-Cs-ut2nW.js";import"./TextFields-8TfbEP0O.js";import"./custom-menu-BbwshV9x.js";import"./external-link-DbBk1ItZ.js";import"./book-open-Cbdc52Ur.js";import"./Add-CN0r1QLK.js";import"./FilterAlt-CXibH0wr.js";import"./select-filter-panel-C_zo36WK.js";import"./form-chip-field-sH5S7-lx.js";import"./chip-list-CkGaRoaT.js";import"./filter-operator-names-BZog1mvA.js";import"./select-Dsco87dL.js";import"./combobox-end-adornment-CaH5Sr_u.js";import"./normalized-model-field-COxh0lBC.js";import"./Edit-JNj6SFDx.js";import"./skeleton-Cp2m1Uyc.js";import"./accordion-DWEV-mKU.js";import"./accordtion-animation-BGCK95Hj.js";import"./checkbox-C4s6ROxp.js";import"./CheckBoxOutlineBlank-DQZJM1Yc.js";import"./formatted-number-DuD1Sa1W.js";import"./use-toggle-dashboard-left-sidebar-CnzMOFB9.js";import"./toggle-left-sidebar-icon-Dq5ZwqwZ.js";import"./ArrowDownward-mN9PlQJw.js";import"./useEffectEvent-DQn3o5L0.js";import"./is-ctrl-key-pressed-BWsUhNJl.js";import"./useGlobalListeners-CeWFSHKo.js";const x=[{key:"type",label:a("Type"),description:a("Type of the attribute"),defaultOperator:d.eq,control:{type:m.Select,defaultValue:"01",options:[{key:"01",label:a("Conversation"),value:"conversation"},{key:"02",label:a("User"),value:"user"},{key:"03",label:a("Other"),value:"custom"}]}},{key:"permission",label:a("Permission"),description:a("Who can view and edit this attribute"),defaultOperator:d.eq,control:{type:m.Select,defaultValue:"01",options:[{key:"01",label:a("Only agents"),value:"agentOnly"},{key:"02",label:a("User can edit"),value:"userCanEdit"},{key:"03",label:a("User can view"),value:"userCanView"}]}},{key:"active",label:a("Status"),description:a("Whether attribute is active or not"),defaultOperator:d.eq,control:{type:m.Select,defaultValue:"01",options:[{key:"01",label:a("Active"),value:!0},{key:"02",label:a("Inactive"),value:!1}]}},{key:"required",label:a("Required"),description:a("Show only required attributes"),defaultOperator:d.eq,control:{type:m.BooleanToggle,defaultValue:!0}},E({description:a("Date attribute was created")}),H({description:a("Date attribute was last updated")})],ae=[{key:"name",visibleInMode:"all",header:()=>e.jsx(s,{message:"Name"}),body:t=>e.jsx("span",{className:"text-primary",children:t.name})},{key:"type",header:()=>e.jsx(s,{message:"Type"}),body:t=>e.jsx(Y,{type:t.type})},{key:"format",header:()=>e.jsx(s,{message:"Format"}),body:t=>e.jsx(ie,{format:t.format})},{key:"active",header:()=>e.jsx(s,{message:"Active"}),body:t=>t.active?e.jsx(f,{className:"text-muted"}):e.jsx(v,{className:"text-muted"})},{key:"updated_at",header:()=>e.jsx(s,{message:"Last updated"}),body:t=>e.jsx(D,{date:t.updated_at})},{key:"actions",hideHeader:!0,align:"end",visibleInMode:"all",header:()=>e.jsx(s,{message:"Actions"}),body:t=>e.jsx(se,{attribute:t}),width:"w-44 flex-shrink-0"}];function se({attribute:t}){const[i,o]=g.useState(!1),r=X(t.id),c=()=>r.mutate({active:!0},{onSuccess:()=>b(a("Activated attribute"))}),p=()=>r.mutate({active:!1},{onSuccess:()=>b(a("Deactivated attribute"))});return e.jsxs(g.Fragment,{children:[i&&e.jsx(k,{type:"modal",isOpen:i,onOpenChange:o,children:e.jsx(re,{attributeId:t.id})}),e.jsxs(A,{children:[e.jsx(S,{className:"text-muted",disabled:r.isPending,children:e.jsx(ee,{})}),e.jsxs(T,{children:[e.jsx(u,{value:"edit",elementType:y,to:`${t.id}/edit`,children:e.jsx(s,{message:"Edit"})}),!t.active&&e.jsx(u,{value:"activate",onSelected:()=>c(),children:e.jsx(s,{message:"Activate"})}),t.active&&e.jsx(u,{value:"deactivate",onSelected:()=>p(),isDisabled:t.key==="name"||t.key==="email",children:e.jsx(s,{message:"Deactivate"})}),e.jsx(u,{value:"delete",className:"text-danger",onSelected:()=>o(!0),isDisabled:t.internal,children:e.jsx(s,{message:"Delete"})})]})]})]})}function ie({format:t}){return t=t.replace(/([A-Z])/g," $1"),e.jsx("span",{className:"capitalize",children:t})}function re({attributeId:t}){const i=oe(),{close:o}=C();return e.jsx(te,{isLoading:i.isPending,title:e.jsx(s,{message:"Delete this attribute?"}),body:e.jsx(s,{message:"This will permanently remove the attribute and cannot be undone."}),confirm:e.jsx(s,{message:"Delete"}),isDanger:!0,onConfirm:()=>{i.mutate({attributeId:t},{onSuccess:()=>o()})}})}function oe(){return P({mutationFn:({attributeId:t})=>I.delete(`helpdesk/attributes/${t}`).then(i=>i.data),onSuccess:async()=>{await F.invalidateQueries({queryKey:h.attributes.invalidateKey}),b(a("Deleted custom attribute"))},onError:t=>w(t,a("Could not delete custom attribute"))})}const ne=""+new URL("text-field-D_PbqZ2Z.svg",import.meta.url).href;function rt(){const t=O(),{searchParams:i,sortDescriptor:o,mergeIntoSearchParams:r,setSearchQuery:c,isFiltering:p}=W(q),l=K(h.attributes.index(i)),j=e.jsx(V,{elementType:y,to:"new",children:e.jsx(s,{message:"Add attribute"})});return e.jsxs(z,{children:[e.jsx(B,{query:l}),e.jsx(L,{children:e.jsx(s,{message:"Attributes"})}),e.jsx(R,{title:e.jsx(s,{message:"Attributes"}),showSidebarToggleButton:!0,rightContent:e.jsx(M,{variant:"button",link:N.pages.attributes,size:"xs"})}),e.jsxs(_,{children:[e.jsx(U,{searchValue:i.query,onSearchChange:c,actions:j,filters:x}),e.jsx($,{filters:x}),e.jsxs(G,{children:[e.jsx(J,{columns:ae,data:l.items,sortDescriptor:o,onSortChange:r,enableSelection:!1,cellHeight:"h-64",onAction:n=>{t(`${n.id}/edit`)}}),l.isEmpty&&e.jsx(Z,{className:"mt-44",isFiltering:p,image:ne,title:e.jsx(s,{message:"No custom attributes have been created yet"}),filteringTitle:e.jsx(s,{message:"No matching attributes"})}),e.jsx(Q,{hideIfOnlyOnePage:!0,query:l,onPageChange:n=>r({page:n}),onPerPageChange:n=>r({perPage:n})})]})]})]})}export{rt as Component};
