import{j as e,T as a,aQ as j,as as p,H as M,aj as V,L as y,r as d,aX as q,p as Q,i as A,s as S,k as C,a as D,al as w,q as b,t as K,m as L,av as I,B as o,aw as P,ag as v,ax as T,az as u,d as W,am as $,an as G,ap as R,aP as O,aq as U}from"./client-OfhJa1Pp.js";import{g as X}from"./main-CqFMqK8-.js";import{A as J}from"./article-path-Da7o5kHE.js";import{a as Y}from"./name-with-avatar-DcHWBlN8.js";import{a as Z,T as ee}from"./table-BifRiqkr.js";import{C as se}from"./chip-list-CkGaRoaT.js";import{E as te}from"./Edit-JNj6SFDx.js";import{A as ae,S as ie}from"./sync-tags-button-CBK7H6fR.js";import{h as f,c as re}from"./custom-menu-BbwshV9x.js";import{H as ne}from"./hc-article-editor-breadcrumb-BnP0k_3v.js";import{u as oe,a as le}from"./use-uningest-articles-hHZAykC4.js";import{V as ce}from"./visible-to-field-I5OzeH9w.js";import{G as me}from"./global-loading-progress-CKXIm6JS.js";import{D as de}from"./data-table-add-item-button-2jwTYQ5G.js";import{D as ue}from"./data-table-header-CeAVoFvI.js";import{D as he}from"./data-table-pagination-footer-CEEx1VtI.js";import{u as ge}from"./use-datatable-search-params-CQGreY35.js";import{D as xe}from"./data-table-emty-state-message-DLsG3g03.js";import{D as je}from"./datatable-filters-C2DdpqvR.js";import{a as pe,D as be,b as fe,c as ye}from"./datatable-page-with-header-layout-B1YkbSHJ.js";import{u as ve}from"./use-datatable-query-BQ-GXlzU.js";import{C as Ae}from"./confirmation-dialog-BIOq1A-h.js";import{o as Se}from"./online-articles-CqWeBVNj.js";import"./category-link-0Q_zOKi3.js";import"./slugify-string-aubjgLQq.js";import"./skeleton-Cp2m1Uyc.js";import"./checkbox-C4s6ROxp.js";import"./CheckBoxOutlineBlank-DQZJM1Yc.js";import"./ArrowDownward-mN9PlQJw.js";import"./useEffectEvent-DQn3o5L0.js";import"./is-ctrl-key-pressed-BWsUhNJl.js";import"./useGlobalListeners-CeWFSHKo.js";import"./section-helper-Cq13cJUI.js";import"./form-chip-field-sH5S7-lx.js";import"./breadcrumb-DMWJORWM.js";import"./ChevronRight-T5gg5A4x.js";import"./MoreHoriz-hMMIYAbm.js";import"./select-Dsco87dL.js";import"./combobox-end-adornment-CaH5Sr_u.js";import"./Add-CN0r1QLK.js";import"./FilterAlt-CXibH0wr.js";import"./select-filter-panel-C_zo36WK.js";import"./filter-operator-names-BZog1mvA.js";import"./normalized-model-field-COxh0lBC.js";import"./accordion-DWEV-mKU.js";import"./accordtion-animation-BGCK95Hj.js";import"./formatted-number-DuD1Sa1W.js";import"./use-toggle-dashboard-left-sidebar-CnzMOFB9.js";import"./toggle-left-sidebar-icon-Dq5ZwqwZ.js";const Ce=[{key:"name",width:"flex-3 min-w-200",visibleInMode:"all",header:()=>e.jsx(a,{message:"Article"}),body:s=>e.jsx(De,{article:s})},{key:"author_id",allowsSorting:!0,width:"min-w-200",visibleInMode:"all",header:()=>e.jsx(a,{message:"Owner"}),body:s=>s.author?e.jsx(Y,{image:s.author.image,label:s.author.name,description:s.author.email,avatarCircle:!0}):null},{key:"draft",allowsSorting:!0,width:"w-100 flex-shrink-0",header:()=>e.jsx(a,{message:"Published"}),body:s=>s.draft?e.jsx(p,{size:"md",className:"text-muted"}):e.jsx(j,{size:"md",className:"text-positive"})},{key:"used_by_ai_agent",allowsSorting:!0,width:"w-100 flex-shrink-0",header:()=>e.jsx(a,{message:"AI agent"}),body:s=>s.used_by_ai_agent?e.jsx(j,{size:"md",className:"text-positive"}):e.jsx(p,{size:"md",className:"text-muted"})},{key:"updated_at",allowsSorting:!0,width:"w-96",header:()=>e.jsx(a,{message:"Last updated"}),body:s=>e.jsx("time",{children:e.jsx(M,{date:s.updated_at})})},{key:"actions",header:()=>e.jsx(a,{message:"Actions"}),width:"w-42 flex-shrink-0",hideHeader:!0,align:"end",visibleInMode:"all",body:s=>e.jsx("div",{className:"text-muted",children:e.jsx(V,{size:"md",elementType:y,to:`${s.id}/edit`,children:e.jsx(te,{})})})}];function De({article:s}){const{isCollapsedMode:t}=d.useContext(Z);return e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[s.tags.length?e.jsx(se,{size:"xs",children:s.tags.slice(0,3).map(i=>e.jsx(q,{children:i},i))}):null,e.jsx(y,{to:`${s.id}/edit`,className:Q("hover:text-primary hover:underline",t?"whitespace-normal":"overflow-hidden overflow-ellipsis whitespace-nowrap font-medium"),children:s.title})]}),!t&&e.jsx("div",{className:"mt-4 text-xs",children:e.jsx(J,{path:s.path})})]})}const _={changeArticleStatus:(s,t)=>({action:"changeArticleStatus",articleIds:s,data:{status:t}}),changeVisibility:(s,t)=>({action:"changeVisibility",articleIds:s,data:{roleId:t}})},k=()=>A({mutationFn:s=>C.post("hc/articles/batch-action",{...s}).then(t=>t.data),onError:s=>S(s)});function Is(){const{aiAgentId:s}=D(),{columns:t,filters:i}=d.useMemo(()=>{const l=Ce.filter(x=>x.key!=="ai_agents_count"||!!s),z=ae.filter(x=>x.key!=="ai_agents_count"||!!s);return{columns:l,filters:z}},[s]),[r,n]=d.useState([]),{searchParams:c,sortDescriptor:h,mergeIntoSearchParams:g,setSearchQuery:B,isFiltering:N}=ge(re),m=ve(f.articles.index(c,s)),F=e.jsx(ne,{}),E=e.jsx(we,{selectedIds:r,onActionDone:()=>{n([]),b.invalidateQueries({queryKey:f.articles.invalidateKey}),b.invalidateQueries({queryKey:X.knowledge.invalidateKey})}}),H=e.jsx(d.Fragment,{children:e.jsx(de,{elementType:y,to:"new",children:e.jsx(a,{message:"Add article"})})});return e.jsxs(pe,{children:[e.jsx(me,{query:m}),e.jsx(be,{title:F,showSidebarToggleButton:!0}),e.jsxs(fe,{children:[e.jsx(ue,{searchValue:c.query,onSearchChange:B,actions:H,selectedItems:r,selectedActions:E,filters:i}),e.jsx(je,{filters:i}),e.jsxs(ye,{children:[e.jsx(ee,{cellHeight:"h-60",columns:t,data:m.items,sortDescriptor:h,onSortChange:g,enableSelection:!0,selectedRows:r,onSelectionChange:n}),m.isEmpty&&e.jsx(xe,{isFiltering:N,image:Se,title:e.jsx(a,{message:"No articles have been created yet"}),filteringTitle:e.jsx(a,{message:"No matching articles"})}),e.jsx(he,{query:m,onPageChange:l=>g({page:l}),onPerPageChange:l=>g({perPage:l})})]})]})]})}function we({selectedIds:s,onActionDone:t}){const{aiAgentId:i}=D();return e.jsxs("div",{className:"flex gap-8",children:[e.jsx(Ie,{selectedIds:s,onSuccess:()=>t()}),e.jsx(Pe,{selectedIds:s,onSuccess:()=>t()}),e.jsx(ie,{taggableType:"article",selectedIds:s,onTagsSynced:()=>t()}),!!i&&e.jsx(_e,{selectedIds:s,onSuccess:()=>t()}),e.jsxs(I,{type:"modal",children:[e.jsx(o,{variant:"flat",color:"danger",children:e.jsx(a,{message:"Delete"})}),e.jsx(ke,{selectedIds:s,onDelete:()=>t()})]})]})}function Ie({selectedIds:s,onSuccess:t}){const i=k();return e.jsxs(P,{onItemSelected:r=>{i.mutate(_.changeArticleStatus(s,r),{onSuccess:()=>t()})},children:[e.jsx(o,{variant:"outline",endIcon:e.jsx(v,{}),disabled:i.isPending,children:e.jsx(a,{message:"Change status"})}),e.jsxs(T,{children:[e.jsx(u,{value:"published",children:e.jsx(a,{message:"Published"})}),e.jsx(u,{value:"draft",children:e.jsx(a,{message:"Draft"})})]})]})}function Pe({selectedIds:s,onSuccess:t}){return e.jsxs(I,{type:"modal",children:[e.jsx(o,{variant:"outline",endIcon:e.jsx(v,{}),children:e.jsx(a,{message:"Change visibility"})}),e.jsx(Te,{selectedIds:s,onSuccess:()=>t()})]})}function Te({selectedIds:s,onSuccess:t}){const{close:i,formId:r}=w(),n=k(),c=W({defaultValues:{visible_to_role:""}});return e.jsxs($,{children:[e.jsx(G,{children:e.jsx(a,{message:"Change visibility"})}),e.jsx(R,{children:e.jsx(O,{id:r,form:c,onSubmit:h=>n.mutate(_.changeVisibility(s,h.visible_to_role),{onSuccess:()=>{i(),t()}}),children:e.jsx(ce,{className:"mb-24",description:e.jsx(a,{message:"Control who can see this article in help center"})})})}),e.jsxs(U,{children:[e.jsx(o,{onClick:()=>i(),children:e.jsx(a,{message:"Cancel"})}),e.jsx(o,{form:r,type:"submit",variant:"flat",color:"primary",disabled:n.isPending,children:e.jsx(a,{message:"Change"})})]})]})}function _e({selectedIds:s,onSuccess:t}){const i=oe(),r=le();return e.jsxs(P,{children:[e.jsx(o,{variant:"outline",endIcon:e.jsx(v,{}),disabled:i.isPending||r.isPending,children:e.jsx(a,{message:"Change AI agent state"})}),e.jsxs(T,{children:[e.jsx(u,{value:"enable",startIcon:e.jsx(j,{size:"sm"}),onSelected:()=>i.mutate({articleIds:s},{onSuccess:()=>t()}),children:e.jsx(a,{message:"Enable for AI agent"})}),e.jsx(u,{value:"disable",startIcon:e.jsx(p,{size:"sm"}),onSelected:()=>r.mutate({articleIds:s},{onSuccess:()=>t()}),children:e.jsx(a,{message:"Disable for AI agent"})})]})]})}function ke({selectedIds:s,onDelete:t}){const{close:i}=w(),r=A({mutationFn:()=>C.delete(`hc/articles/${s.join(",")}`),onSuccess:async()=>{await b.invalidateQueries({queryKey:f.articles.invalidateKey}),K(L("Articles deleted")),t(),i()},onError:n=>S(n)});return e.jsx(Ae,{isDanger:!0,isLoading:r.isPending,title:e.jsx(a,{message:"Delete articles"}),body:e.jsx(a,{message:"Are you sure you want to delete selected articles?",values:{count:s.length}}),confirm:e.jsx(a,{message:"Delete"}),onConfirm:()=>r.mutate()})}export{Is as Component,ke as DeleteArticlesDialog};
