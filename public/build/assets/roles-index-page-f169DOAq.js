import{h as D,j as e,r as l,L as x,T as s,H as b,av as y,aw as v,aj as C,ax as T,az as c,al as S,i as w,s as I,q as P,k as E}from"./client-OfhJa1Pp.js";import{A}from"./admin-config-tfY5n3F7.js";import{v as k,c as g,l as H}from"./main-CqFMqK8-.js";import{D as L}from"./settings-links-D22SAe6v.js";import{G as M}from"./global-loading-progress-CKXIm6JS.js";import{D as N}from"./data-table-export-csv-button-9QYFEqF2.js";import{D as B}from"./data-table-add-item-button-2jwTYQ5G.js";import{D as F}from"./data-table-header-CeAVoFvI.js";import{D as R}from"./data-table-pagination-footer-CEEx1VtI.js";import{u as q}from"./use-datatable-search-params-CQGreY35.js";import{D as O}from"./data-table-emty-state-message-DLsG3g03.js";import{a as Q,D as $,b as z,c as W}from"./datatable-page-with-header-layout-B1YkbSHJ.js";import{u as G}from"./use-datatable-query-BQ-GXlzU.js";import{T as K}from"./table-BifRiqkr.js";import{D as V}from"./Delete-BhyMZiPM.js";import{E as _}from"./Edit-JNj6SFDx.js";import{M as U}from"./MoreVert-Ci70_mZh.js";import{C as J}from"./confirmation-dialog-BIOq1A-h.js";import{T as X,a as Y,b as Z}from"./tabs-BfUlcoJh.js";import{t as ee}from"./team-DYmDDGxN.js";import"./dashboard-icons-CHop3mns.js";import"./library-icon-CHCHM-UW.js";import"./messages-square-icon-CTmom_u4.js";import"./Home--R_oEr6a.js";import"./SupervisorAccount-k9OnPB-d.js";import"./Translate-Cs-ut2nW.js";import"./TextFields-8TfbEP0O.js";import"./custom-menu-BbwshV9x.js";import"./external-link-DbBk1ItZ.js";import"./book-open-Cbdc52Ur.js";import"./FileDownload-DoJWzr8l.js";import"./download-file-from-url-hJ3EUwXO.js";import"./Add-CN0r1QLK.js";import"./FilterAlt-CXibH0wr.js";import"./select-filter-panel-C_zo36WK.js";import"./form-chip-field-sH5S7-lx.js";import"./chip-list-CkGaRoaT.js";import"./filter-operator-names-BZog1mvA.js";import"./select-Dsco87dL.js";import"./combobox-end-adornment-CaH5Sr_u.js";import"./normalized-model-field-COxh0lBC.js";import"./skeleton-Cp2m1Uyc.js";import"./accordion-DWEV-mKU.js";import"./accordtion-animation-BGCK95Hj.js";import"./checkbox-C4s6ROxp.js";import"./CheckBoxOutlineBlank-DQZJM1Yc.js";import"./use-toggle-dashboard-left-sidebar-CnzMOFB9.js";import"./toggle-left-sidebar-icon-Dq5ZwqwZ.js";import"./ArrowDownward-mN9PlQJw.js";import"./useEffectEvent-DQn3o5L0.js";import"./is-ctrl-key-pressed-BWsUhNJl.js";import"./useGlobalListeners-CeWFSHKo.js";const te=[{key:"name",allowsSorting:!0,visibleInMode:"all",header:()=>e.jsx(s,{message:"Role"}),body:t=>e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(s,{message:t.name})}),e.jsx("div",{className:"overflow-x-hidden overflow-ellipsis text-xs text-muted",children:t.description?e.jsx(s,{message:t.description}):void 0})]})},{key:"updated_at",maxWidth:"max-w-100",allowsSorting:!0,header:()=>e.jsx(s,{message:"Last updated"}),body:t=>e.jsx(b,{date:t.updated_at})},{key:"actions",header:()=>e.jsx(s,{message:"Actions"}),hideHeader:!0,visibleInMode:"all",align:"end",width:"w-84 flex-shrink-0",body:t=>e.jsx(se,{role:t})}];function at(){var p;const t=D(),{searchParams:o,sortDescriptor:i,mergeIntoSearchParams:n,setSearchQuery:u,isFiltering:h}=q(k),m=G(g.roles.index(o)),j=e.jsxs(l.Fragment,{children:[e.jsx(N,{endpoint:"roles/csv/export"}),e.jsx(B,{elementType:x,to:`new?type=${o.type??"users"}`,children:e.jsx(s,{message:"Add new role"})})]}),r=(p=l.useContext(H).roles)==null?void 0:p.types,f=o.type?r==null?void 0:r.findIndex(a=>a.type===o.type):0,d=r!=null&&r.length?e.jsx(X,{selectedTab:f,onTabChange:a=>{n({type:r[a].type})},children:e.jsx(Y,{className:"mx-24",children:r.map(a=>e.jsx(Z,{className:"min-w-100",children:e.jsx(s,{...a.label})},a.type))})}):null;return e.jsxs(Q,{children:[e.jsx(M,{query:m}),e.jsx($,{title:e.jsx(s,{message:"Roles"}),showSidebarToggleButton:!0,border:d?"border-none":void 0,rightContent:e.jsx(L,{variant:"button",link:A.pages.roles,size:"xs"})}),d,e.jsxs(z,{children:[e.jsx(F,{searchValue:o.query,onSearchChange:u,actions:j}),e.jsxs(W,{children:[e.jsx(K,{columns:te,data:m.items,sortDescriptor:i,onSortChange:n,enableSelection:!1,onAction:a=>t(`${a.id}/edit`),cellHeight:"h-64"}),m.isEmpty?e.jsx(O,{image:ee,isFiltering:h,title:e.jsx(s,{message:"No roles have been created yet"}),filteringTitle:e.jsx(s,{message:"No matching roles"})}):null,e.jsx(R,{query:m,onPageChange:a=>n({page:a}),onPerPageChange:a=>n({perPage:a})})]})]})]})}function se({role:t}){const[o,i]=l.useState(!1);return e.jsxs(l.Fragment,{children:[e.jsx(y,{type:"modal",isOpen:o,onOpenChange:i,children:e.jsx(ae,{roleId:t.id})}),e.jsxs(v,{children:[e.jsx(C,{size:"md",className:"text-muted",children:e.jsx(U,{})}),e.jsxs(T,{children:[e.jsx(c,{value:"edit",elementType:x,to:`${t.id}/edit`,startIcon:e.jsx(_,{}),children:e.jsx(s,{message:"Edit"})}),!t.internal&&e.jsx(c,{value:"delete",onSelected:()=>i(!0),startIcon:e.jsx(V,{}),children:e.jsx(s,{message:"Delete"})})]})]})]})}function ae({roleId:t}){const{close:o}=S(),i=w({mutationFn:()=>E.delete(`roles/${t}`),onSuccess:()=>{P.invalidateQueries({queryKey:g.roles.invalidateKey}),o()},onError:n=>I(n)});return e.jsx(J,{isDanger:!0,title:e.jsx(s,{message:"Delete role"}),body:e.jsx(s,{message:"Are you sure you want to delete this role?"}),confirm:e.jsx(s,{message:"Delete"}),isLoading:i.isPending,onConfirm:()=>{i.mutate()}})}export{at as Component};
