var K=r=>{throw TypeError(r)};var F=(r,e,t)=>e.has(r)||K("Cannot "+t);var n=(r,e,t)=>(F(r,e,"read from private field"),t?t.call(r):e.get(r)),d=(r,e,t)=>e.has(r)?K("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),c=(r,e,t,s)=>(F(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t),b=(r,e,t)=>(F(r,e,"access private method"),t);import{c4 as Y,Q as H,c5 as Z,O as ee,V as W,M as te,c6 as se,c7 as re,r as Q,c8 as ie,c9 as oe,ca as ne,cb as ae,cc as N,cd as _,ce as ue,cf as pe,bV as ce,i as he,q as me,l as I,t as le,m as de,k as fe,j as v,T as X,h as be,d as ge}from"./client-OfhJa1Pp.js";import{p as ye,C as ve}from"./use-create-canned-reply-CgecIWMt.js";import{o as Ce,u as Oe}from"./custom-menu-BbwshV9x.js";import{C as Re}from"./crupdate-resource-layout-D52z_ZDE.js";import{h as Ee}from"./main-CqFMqK8-.js";import{B as Qe,a as $}from"./breadcrumb-DMWJORWM.js";import"./variable-extension-Cjf6-ocs.js";import"./get-default-values-for-form-with-attributes-htMbgWW2.js";import"./campaign-conditions-config-DJxMZaUr.js";import"./select-Dsco87dL.js";import"./combobox-end-adornment-CaH5Sr_u.js";import"./Event-7FmyLdJJ.js";import"./ToggleOn-DZgCezoB.js";import"./TextFields-8TfbEP0O.js";import"./Add-CN0r1QLK.js";import"./index-W-EjzbYI.js";import"./with-selector-CDgEpx5P.js";import"./DataObject-XQLwxsph.js";import"./action-menu-dialog-Dkivr19T.js";import"./combobox-pHOmOE77.js";import"./article-link-xsQ04UkN.js";import"./slugify-string-aubjgLQq.js";import"./article-path-Da7o5kHE.js";import"./category-link-0Q_zOKi3.js";import"./list-buttons-BgDZUgyW.js";import"./FormatListNumbered-rvs8UAfH.js";import"./tiptap-editor-context-BAgvnYfz.js";import"./Link-DfTxpaxj.js";import"./library-icon-CHCHM-UW.js";import"./use-keybind-7f4ijAco.js";import"./useGlobalListeners-CeWFSHKo.js";import"./is-ctrl-key-pressed-BWsUhNJl.js";import"./emoji-picker-button-CQGpXygB.js";import"./enhance-text-with-ai-button-CxIfCpJn.js";import"./use-is-module-installed-FCoToztC.js";import"./OpenInFull-HWkxb3KN.js";import"./Spellcheck-Bs1hoM4Q.js";import"./progress-bar-iRLStr1h.js";import"./upload-attachments-button-BWcvmOOE.js";import"./image-button-ExYLUK-F.js";import"./image-up-DCwS84Wx.js";import"./use-active-upload-CCDRf1Tl.js";import"./file-upload-provider-DTPBUrkd.js";import"./uploaded-file-DN6fXT4v.js";import"./pretty-bytes-bO14ePu9.js";import"./open-upload-window-CSDcieK1.js";import"./shallow-BSWIanyL.js";import"./file-preview-dialog-DZbR1Zhl.js";import"./file-thumbnail-D9-TxWtC.js";import"./file-type-icon-Dok_AF4H.js";import"./ChevronLeft-B96ua4ZU.js";import"./ChevronRight-T5gg5A4x.js";import"./FileDownload-DoJWzr8l.js";import"./download-file-from-url-hJ3EUwXO.js";import"./formatted-bytes-CmuQhzYn.js";import"./use-upload-attachments-D0EFLOL9.js";import"./use-droppable-DqkAoZym.js";import"./paperclip-DIi_RQSY.js";import"./reply-composer-container-CGWK_3_X.js";import"./formatted-message-body-WNPn2fpJ.js";import"./index-DTFmR8Ac.js";import"./core-Dg-ESrC8.js";import"./index-RecbqAl0.js";import"./floating-toolbar-Db61G721.js";import"./button-group-Cs5CuUiC.js";import"./form-chip-field-sH5S7-lx.js";import"./chip-list-CkGaRoaT.js";import"./PushPin-Df_CN_Sp.js";import"./datatable-page-with-header-layout-B1YkbSHJ.js";import"./use-toggle-dashboard-left-sidebar-CnzMOFB9.js";import"./toggle-left-sidebar-icon-Dq5ZwqwZ.js";import"./useEffectEvent-DQn3o5L0.js";import"./MoreHoriz-hMMIYAbm.js";function G(r,e){const t=new Set(e);return r.filter(s=>!t.has(s))}function xe(r,e,t){const s=r.slice(0);return s[e]=t,s}var x,l,S,w,f,O,j,k,M,P,p,T,z,V,A,D,J,Se=(J=class extends Y{constructor(e,t,s){super();d(this,p);d(this,x);d(this,l);d(this,S);d(this,w);d(this,f);d(this,O);d(this,j);d(this,k);d(this,M);d(this,P,[]);c(this,x,e),c(this,w,s),c(this,S,[]),c(this,f,[]),c(this,l,[]),this.setQueries(t)}onSubscribe(){this.listeners.size===1&&n(this,f).forEach(e=>{e.subscribe(t=>{b(this,p,A).call(this,e,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,n(this,f).forEach(e=>{e.destroy()})}setQueries(e,t){c(this,S,e),c(this,w,t),H.batch(()=>{const s=n(this,f),o=b(this,p,V).call(this,n(this,S));o.forEach(u=>u.observer.setOptions(u.defaultedQueryOptions));const i=o.map(u=>u.observer),a=i.map(u=>u.getCurrentResult()),h=s.length!==i.length,C=i.some((u,E)=>u!==s[E]),R=h||C,B=R?!0:a.some((u,E)=>{const q=n(this,l)[E];return!q||!Z(u,q)});!R&&!B||(R&&(c(this,P,o),c(this,f,i)),c(this,l,a),this.hasListeners()&&(R&&(G(s,i).forEach(u=>{u.destroy()}),G(i,s).forEach(u=>{u.subscribe(E=>{b(this,p,A).call(this,u,E)})})),b(this,p,D).call(this)))})}getCurrentResult(){return n(this,l)}getQueries(){return n(this,f).map(e=>e.getCurrentQuery())}getObservers(){return n(this,f)}getOptimisticResult(e,t){const s=b(this,p,V).call(this,e),o=s.map(a=>a.observer.getOptimisticResult(a.defaultedQueryOptions)),i=s.map(a=>a.defaultedQueryOptions.queryHash);return[o,a=>b(this,p,z).call(this,a??o,t,i),()=>b(this,p,T).call(this,o,s)]}},x=new WeakMap,l=new WeakMap,S=new WeakMap,w=new WeakMap,f=new WeakMap,O=new WeakMap,j=new WeakMap,k=new WeakMap,M=new WeakMap,P=new WeakMap,p=new WeakSet,T=function(e,t){return t.map((s,o)=>{const i=e[o];return s.defaultedQueryOptions.notifyOnChangeProps?i:s.observer.trackResult(i,a=>{t.forEach(h=>{h.observer.trackProp(a)})})})},z=function(e,t,s){if(t){const o=n(this,M),i=s!==void 0&&o!==void 0&&(o.length!==s.length||s.some((a,h)=>a!==o[h]));return(!n(this,O)||n(this,l)!==n(this,k)||i||t!==n(this,j))&&(c(this,j,t),c(this,k,n(this,l)),s!==void 0&&c(this,M,s),c(this,O,ee(n(this,O),t(e)))),n(this,O)}return e},V=function(e){const t=new Map;n(this,f).forEach(o=>{const i=o.options.queryHash;if(!i)return;const a=t.get(i);a?a.push(o):t.set(i,[o])});const s=[];return e.forEach(o=>{var C;const i=n(this,x).defaultQueryOptions(o),h=((C=t.get(i.queryHash))==null?void 0:C.shift())??new W(n(this,x),i);s.push({defaultedQueryOptions:i,observer:h})}),s},A=function(e,t){const s=n(this,f).indexOf(e);s!==-1&&(c(this,l,xe(n(this,l),s,t)),b(this,p,D).call(this))},D=function(){var e;if(this.hasListeners()){const t=n(this,O),s=b(this,p,T).call(this,n(this,l),n(this,P)),o=b(this,p,z).call(this,s,(e=n(this,w))==null?void 0:e.combine);t!==o&&H.batch(()=>{this.listeners.forEach(i=>{i(n(this,l))})})}},J);function we({queries:r,...e},t){const s=te(t),o=se(),i=re(),a=Q.useMemo(()=>r.map(m=>{const g=s.defaultQueryOptions(m);return g._optimisticResults=o?"isRestoring":"optimistic",g}),[r,s,o]);a.forEach(m=>{ie(m);const g=s.getQueryCache().get(m.queryHash);oe(m,i,g)}),ne(i);const[h]=Q.useState(()=>new Se(s,a,e)),[C,R,B]=h.getOptimisticResult(a,e.combine),u=!o&&e.subscribed!==!1;Q.useSyncExternalStore(Q.useCallback(m=>u?h.subscribe(H.batchCalls(m)):ae,[h,u]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),Q.useEffect(()=>{h.setQueries(a,e)},[a,e,h]);const q=C.some((m,g)=>N(a[g],m))?C.flatMap((m,g)=>{const y=a[g];if(y){const U=new W(s,y);if(N(y,m))return _(y,U,i);ue(m,o)&&_(y,U,i)}return[]}):[];if(q.length>0)throw Promise.all(q);const L=C.find((m,g)=>{const y=a[g];return y&&pe({result:m,errorResetBoundary:i,throwOnError:y.throwOnError,query:s.getQueryCache().get(y.queryHash),suspense:y.suspense})});if(L!=null&&L.error)throw L.error;return R(B())}function qe(r,e){return we({...r,queries:r.queries.map(t=>({...t,suspense:!0,throwOnError:ce,enabled:!0,placeholderData:void 0}))},e)}function je(r,e){return he({mutationFn:t=>ke(e,t),onSuccess:async()=>{await me.invalidateQueries({queryKey:I.cannedReplies.invalidateKey}),le(de("Reply updated"))},onError:t=>Ce(t,r)})}function ke(r,e){return fe.put(`helpdesk/canned-replies/${r}`,ye(e)).then(t=>t.data)}function Yt(){const{replyId:r}=Oe(["replyId"]),[,e]=qe({queries:[I.groups.normalizedList,I.cannedReplies.get(r)]});return v.jsxs(Q.Fragment,{children:[v.jsx(Ee,{children:v.jsx(X,{message:"Edit saved reply"})}),v.jsx(Me,{cannedReply:e.data.reply})]})}function Me({cannedReply:r}){const e=be(),t=ge({defaultValues:{name:r.name,body:r.body,attachments:r.attachments,shared:r.shared,groupId:r.group_id,tags:r.tags}}),s=je(t,r.id),o=i=>{i=i||t.getValues(),s.mutate(i,{onSuccess:()=>{e("../..",{relative:"path"})}})};return v.jsx(Re,{form:t,onSubmit:o,title:v.jsxs(Qe,{size:"xl",children:[v.jsx($,{to:"../saved-replies",children:v.jsx(X,{message:"Saved replies"})}),v.jsx($,{children:r.name})]}),isLoading:s.isPending,disableSaveWhenNotDirty:!0,children:v.jsx(ve,{})})}export{Yt as Component};
