import{j as e,T as t,H as b,b0 as L,bs as w,bU as k,bb as D,p as N,r as T,a_ as F,c as B,Z as A,l as S,B as V,L as O}from"./client-OfhJa1Pp.js";import{u as P,R as $}from"./use-date-range-DQ4Wr2NA.js";import{T as M}from"./teammate-performance-table-DqiEYQKF.js";import{R as g}from"./admin-report-card-row-K8k-x4Fn.js";import{B as C}from"./bar-chart-BtaTD80E.js";import{C as z}from"./chart-layout-CpYjFOEM.js";import{L as E}from"./line-chart-BgahLr8I.js";import{C as H}from"./report-table-Cn_isdcT.js";import{h as Q}from"./main-CqFMqK8-.js";import{F as q}from"./formatted-duration-6c7isaot.js";import{F as G}from"./formatted-number-DuD1Sa1W.js";import"./use-is-module-installed-FCoToztC.js";import"./datatable-page-with-header-layout-B1YkbSHJ.js";import"./use-toggle-dashboard-left-sidebar-CnzMOFB9.js";import"./toggle-left-sidebar-icon-Dq5ZwqwZ.js";import"./select-Dsco87dL.js";import"./combobox-end-adornment-CaH5Sr_u.js";import"./name-with-avatar-DcHWBlN8.js";import"./skeleton-Cp2m1Uyc.js";import"./external-link-DbBk1ItZ.js";import"./TrendingFlat-DBEm8S3C.js";import"./formatted-bytes-CmuQhzYn.js";import"./pretty-bytes-bO14ePu9.js";import"./table-BifRiqkr.js";import"./checkbox-C4s6ROxp.js";import"./CheckBoxOutlineBlank-DQZJM1Yc.js";import"./ArrowDownward-mN9PlQJw.js";import"./useEffectEvent-DQn3o5L0.js";import"./is-ctrl-key-pressed-BWsUhNJl.js";import"./useGlobalListeners-CeWFSHKo.js";import"./ArrowDropUp-TtMj7pr0.js";import"./custom-menu-BbwshV9x.js";const I={month:"long",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"};function U({date:s}){const o=e.jsx(b,{date:s,options:I});return e.jsxs("div",{className:"mt-44 text-center text-sm text-muted/40",children:[e.jsx("p",{children:e.jsx(t,{message:"This report was generated on :date",values:{date:o}})}),e.jsx("p",{children:e.jsx(t,{message:"All reports are displayed in your local time."})})]})}const Z=[0,1,2,3,4,5,6],R=["0-2","2-4","4-6","6-8","8-10","10-12","12-14","14-16","16-18","18-20","20-22","22-24"];function _({report:s,className:o,colSpan:i="col-span-7",rowSpan:m="row-span-11"}){const a=L(),c=w({weekday:"short"}),p=k(D(),a.localeCode);return e.jsx(z,{title:e.jsx(t,{message:"Busiest time of day"}),className:N(o,i,m,"compact-scrollbar overflow-x-auto overflow-y-hidden"),children:e.jsxs("div",{className:"grid w-full grid-cols-[max-content,repeat(12,minmax(66px,1fr))] gap-1",children:[e.jsx("div",{className:"spacer"}),R.map(r=>e.jsx("div",{className:"py-6 text-center text-xs font-semibold",children:r},r)),Z.map(r=>e.jsxs(T.Fragment,{children:[e.jsx("div",{className:"flex h-44 items-center pr-10 text-xs font-semibold",children:c.format(p.add({days:r}).toDate())}),R.map(l=>{const n=s?s.datasets[0].data[r].value[l]:0;return e.jsx(F,{label:e.jsxs("span",{children:[e.jsx(t,{message:(s==null?void 0:s.datasets[0].label)??"No data",values:{count:n}}),": ",n]}),children:e.jsx("div",{className:"h-44 bg-primary opacity-10 transition-opacity",style:{opacity:s?J(n,s.datasets[0].max):.1}})},l)})]},r))]})})}function J(s,o){return s===0?.1:Math.max(.1,Math.min(1,s/o))}function Ne(){var c,p,r,l,n,d,x,u,j,h,f,v,y;const{pathname:s}=B(),o=s.split("/").pop()==="tickets"?"ticket":"chat",[i,m]=P(),a=A(S.reports.get(`reports/conversations/${o}`,i));return e.jsxs($,{dateRange:i,channel:o==="ticket"?"tickets":"chats",onDateRangeChange:m,title:o==="ticket"?e.jsx(t,{message:"Tickets"}):e.jsx(t,{message:"Chats"}),children:[e.jsx(Q,{children:o==="ticket"?e.jsx(t,{message:"Reports - Tickets"}):e.jsx(t,{message:"Reports - Chats"})}),e.jsxs("div",{className:"chart-grid",children:[e.jsx(K,{data:a.data}),e.jsx(E,{colSpan:"col-span-8",data:(c=a.data)==null?void 0:c.newConversations,isLoading:a.isLoading,title:e.jsx(t,{message:"New conversations"}),hideLegend:!0,description:e.jsx(t,{message:":count total conversations",values:{count:e.jsx(G,{value:((l=(r=(p=a.data)==null?void 0:p.newConversations)==null?void 0:r.datasets[0])==null?void 0:l.total)||0})}})}),e.jsx(C,{colSpan:"col-span-4",data:(n=a.data)==null?void 0:n.firstReplyTimes,direction:"vertical",individualBarColors:!0,isLoading:a.isLoading,hideLegend:!0,title:o==="ticket"?e.jsx(t,{message:"Hours until first agent reply"}):e.jsx(t,{message:"Minutes until first agent reply"}),description:(x=(d=a.data)==null?void 0:d.firstReplyTimes.datasets[0])!=null&&x.average?e.jsx(t,{message:":time average",values:{time:e.jsx(q,{seconds:((j=(u=a.data)==null?void 0:u.firstReplyTimes.datasets[0])==null?void 0:j.average)||0,verbose:!0})}}):null}),e.jsx(_,{report:(h=a.data)==null?void 0:h.busiestTimeOfDay}),e.jsx(C,{colSpan:"col-span-5",title:e.jsx(t,{message:"Conversations by tag"}),data:(f=a.data)==null?void 0:f.tags,direction:"horizontal",isLoading:a.isLoading,individualBarColors:!0,hideLegend:!0}),e.jsx(H,{label:e.jsx(t,{message:"Teammate performance"}),actions:e.jsx(V,{variant:"outline",color:"primary",elementType:O,to:"../teammates",relative:"path",size:"xs",children:e.jsx(t,{message:"View all"})}),children:e.jsx(M,{report:(v=a.data)==null?void 0:v.agents})})]}),(y=a.data)!=null&&y.newConversations.generatedAt?e.jsx(U,{date:a.data.newConversations.generatedAt}):null]})}function K({data:s}){var a,c,p,r,l,n,d,x;const o=s==null?void 0:s.newConversations.datasets[0],i=s==null?void 0:s.newConversations.datasets[1],m=!s;return e.jsxs(T.Fragment,{children:[e.jsx(g,{currentValue:(o==null?void 0:o.total)??0,previousValue:(i==null?void 0:i.total)??void 0,isLoading:m,children:e.jsx(t,{message:"New Conversations"})}),e.jsx(g,{currentValue:((c=(a=s==null?void 0:s.agents)==null?void 0:a.datasets[0])==null?void 0:c.totalAgentReplies)??0,previousValue:((r=(p=s==null?void 0:s.agents)==null?void 0:p.datasets[1])==null?void 0:r.totalAgentReplies)??void 0,isLoading:m,children:e.jsx(t,{message:"Total agent replies"})}),e.jsx(g,{currentValue:((n=(l=s==null?void 0:s.agents)==null?void 0:l.datasets[0])==null?void 0:n.avgResponseTime)??0,previousValue:((x=(d=s==null?void 0:s.agents)==null?void 0:d.datasets[1])==null?void 0:x.avgResponseTime)??void 0,isLoading:m,type:"durationInSeconds",children:e.jsx(t,{message:"Average response time"})}),e.jsx(g,{type:"percentage",currentValue:(o==null?void 0:o.solvedOnFirstReplyPercentage)??0,previousValue:(i==null?void 0:i.solvedOnFirstReplyPercentage)??void 0,isLoading:m,children:e.jsx(t,{message:"Closed on first reply"})})]})}export{Ne as Component};
