import{Z as N,r as m,j as e,aw as A,T as i,ag as C,ax as M,az as V,t as b,m as y,l as u,i as L,s as k,k as q,q as p,av as g,al as E,p as w,B as K,am as z,a_ as F,aj as G}from"./client-OfhJa1Pp.js";import{u as H,C as x,T as Q,A as R,a as S,b as Z,c as _}from"./use-active-view-name-D6uPeR5G.js";import{D as $,h as J,G as U}from"./main-CqFMqK8-.js";import{C as W,u as X}from"./conversations-list-item-D6_xxcEr.js";import{u as Y,C as ee}from"./column-selector-C00FaZdf.js";import{S as se}from"./get-status-color-HuOrk9nw.js";import{F as te,a as oe}from"./dashboard-icons-CHop3mns.js";import{u as j}from"./use-keybind-7f4ijAco.js";import{D as ae}from"./Delete-BhyMZiPM.js";import{C as ne}from"./confirmation-dialog-BIOq1A-h.js";import{S as ie}from"./SupervisorAccount-k9OnPB-d.js";import{G as re}from"./generic-conversations-table-DDCPonwk.js";import{I as me,a as le}from"./inbox-views-sidebar-MuCCM0pX.js";import{G as I}from"./global-loading-progress-CKXIm6JS.js";import{D as T}from"./data-table-pagination-footer-CEEx1VtI.js";import{D}from"./datatable-page-with-header-layout-B1YkbSHJ.js";import{M as ce}from"./messages-square-icon-CTmom_u4.js";import{T as ue}from"./toggle-left-sidebar-icon-Dq5ZwqwZ.js";import{I as de}from"./custom-menu-BbwshV9x.js";import"./action-menu-dialog-Dkivr19T.js";import"./combobox-pHOmOE77.js";import"./combobox-end-adornment-CaH5Sr_u.js";import"./PushPin-Df_CN_Sp.js";import"./agent-avatar-CN8Be1Dj.js";import"./use-compact-agents-VrJm5fj6.js";import"./helpdesk-channel-CQKSbeKg.js";import"./online-status-circle-QXiKm4xe.js";import"./HourglassEmpty-BpvqVftp.js";import"./checkbox-C4s6ROxp.js";import"./CheckBoxOutlineBlank-DQZJM1Yc.js";import"./use-filter-KNtT5Txy.js";import"./Add-CN0r1QLK.js";import"./use-is-module-installed-FCoToztC.js";import"./use-datatable-search-params-CQGreY35.js";import"./useInfiniteQuery-Dr3ouRcV.js";import"./infiniteQueryObserver-dCGK3uny.js";import"./customer-avatar-DNefi2od.js";import"./ConfirmationNumber-8T4bmILd.js";import"./use-all-available-columns-CiPDP24p.js";import"./DragIndicator-BbWWPJ1P.js";import"./use-sortable-DQoLtUe2.js";import"./isScrollable-BSEN4xi5.js";import"./use-droppable-DqkAoZym.js";import"./uploaded-file-DN6fXT4v.js";import"./useGlobalListeners-CeWFSHKo.js";import"./library-icon-CHCHM-UW.js";import"./Home--R_oEr6a.js";import"./is-ctrl-key-pressed-BWsUhNJl.js";import"./attribute-renderer-BAh3glGI.js";import"./ThumbDown-CmU9VZYm.js";import"./ThumbUp-B7v5mSGQ.js";import"./conversation-priority-tSI_39cp.js";import"./unseen-messages-badge-BC9Ql5Uh.js";import"./websocket-updates-notifier-CaEDKM_o.js";import"./chip-list-CkGaRoaT.js";import"./table-BifRiqkr.js";import"./skeleton-Cp2m1Uyc.js";import"./ArrowDownward-mN9PlQJw.js";import"./useEffectEvent-DQn3o5L0.js";import"./formatted-number-DuD1Sa1W.js";import"./Tune-DusFnn8x.js";import"./select-Dsco87dL.js";import"./use-toggle-dashboard-left-sidebar-CnzMOFB9.js";function pe({conversationIds:t,onSuccess:s}){var c;const o=H(),n=N(u.statuses.dropdownList("agent")),[a,l]=m.useState(!1);return j("window","s",()=>l(!0)),e.jsxs(A,{isOpen:a,onOpenChange:l,onItemSelected:r=>o.mutate({conversationIds:t,statusId:r},{onSuccess:()=>{s==null||s(),b(y("Status changed"))}}),children:[e.jsx(x,{startIcon:e.jsx(te,{}),endIcon:e.jsx(C,{}),disabled:o.isPending,children:e.jsx(i,{message:"Status (s)"})}),e.jsx(M,{children:(c=n.data)==null?void 0:c.statuses.map(r=>e.jsx(V,{value:r.id,startIcon:e.jsx(se,{category:r.category}),children:e.jsx(i,{message:r.label})},r.id))})]})}function ge(){return L({mutationFn:t=>q.delete(`helpdesk/agent/conversations/${t.ids.join(",")}`).then(s=>s.data),onSuccess:async()=>{await p.invalidateQueries({queryKey:u.conversations.invalidateKey}),p.invalidateQueries({queryKey:u.views.invalidateKey}),b(y("Conversations deleted"))},onError:t=>k(t)})}function xe({conversationIds:t,onSuccess:s,isCompact:o}){const[n,a]=m.useState(!1);return j("window","d",()=>a(!0)),e.jsxs(g,{type:"modal",isOpen:n,onOpenChange:a,children:[e.jsx(x,{startIcon:e.jsx(ae,{}),color:"danger",isCompact:o,children:e.jsx(i,{message:"Delete (d)"})}),e.jsx(je,{conversationIds:t,onDeleted:s})]})}function je({conversationIds:t,onDeleted:s}){const o=ge(),{close:n}=E();return e.jsx(ne,{isDanger:!0,isLoading:o.isPending,onConfirm:()=>{o.mutate({ids:t},{onSuccess:()=>{n(),s==null||s()}})},title:e.jsx(i,{message:"Delete conversations"}),body:e.jsx(i,{message:"Are you sure you want to delete selected conversations?"}),confirm:e.jsx(i,{message:"delete"})})}function fe({conversationIds:t,onSuccess:s,isCompact:o}){const[n,a]=m.useState(!1);return j("window","a",()=>a(!0)),e.jsxs(g,{type:"modal",isOpen:n,onOpenChange:a,children:[e.jsx(x,{isCompact:o,startIcon:e.jsx(ie,{}),endIcon:e.jsx(C,{}),children:e.jsx(i,{message:"Assign (a)"})}),e.jsx(Q,{conversationIds:t,onTransfer:s})]})}function he({conversationIds:t,onActionCompleted:s,className:o}){return e.jsxs("div",{className:w("flex w-max items-center justify-center gap-12",o),children:[e.jsx(fe,{conversationIds:t,onSuccess:s}),e.jsx(pe,{conversationIds:t,onSuccess:s}),e.jsx(R,{conversationIds:t,onSuccess:s}),e.jsx(xe,{conversationIds:t,onSuccess:s})]})}function As(){const{isMobileMode:t}=m.useContext($),s=t?e.jsx(Ce,{}):e.jsx(ve,{});return e.jsxs(m.Fragment,{children:[e.jsx(me,{location:"conversationsTable"}),s]})}function ve(){var v;const t=X(),[s,o]=m.useState([]),{query:n,items:a,isEmpty:l,mergeIntoSearchParams:c,sortDescriptor:r}=S(),f="conversationsPage",h=(v=n.data)==null?void 0:v.columns,[B]=Y(f,h);return e.jsxs("div",{className:"dashboard-rounded-panel dashboard-grid-content flex flex-col lg:ml-8",children:[e.jsx(I,{query:n}),e.jsx(D,{title:e.jsx(P,{}),toggleButton:e.jsx(ye,{}),padding:"p-12",rightContent:e.jsxs("div",{children:[e.jsx(ee,{tableName:f,defaultColumns:h}),e.jsx(Z,{size:"sm"})]}),leftContent:s.length?e.jsx(he,{className:"ml-12",conversationIds:s,onActionCompleted:()=>{o([]),p.invalidateQueries({queryKey:u.conversations.invalidateKey})}}):null}),e.jsx("div",{className:w("flex-auto overflow-y-auto",l&&"flex items-center justify-center"),children:l?e.jsx(O,{}):e.jsx(re,{data:a,activeColumns:B,selectedTickets:s,onSelectionChange:o,sortDescriptor:r,onSortChange:c,onRowAction:d=>{t(d.id)}})}),e.jsx(T,{hideIfOnlyOnePage:!0,className:"flex-shrink-0",onPageChange:d=>c({page:d}),query:n})]})}function Ce(){const{query:t,items:s,isEmpty:o,mergeIntoSearchParams:n}=S();return e.jsxs("div",{className:"dashboard-grid-content flex min-h-0 flex-col",children:[e.jsx(I,{query:t}),e.jsx(D,{title:e.jsx(P,{}),showSidebarToggleButton:!0,padding:"p-12",rightContent:e.jsx(be,{})}),e.jsx("div",{className:"space-y-4 overflow-y-auto px-8",children:s.map(a=>e.jsx(W,{conversation:a},a.id))}),o&&e.jsx(O,{}),e.jsx(T,{hideIfOnlyOnePage:!0,className:"flex-shrink-0",onPageChange:a=>n({page:a}),query:t})]})}function be(){const[t,s]=m.useState(!1);return e.jsxs(g,{type:"modal",isOpen:t,onOpenChange:s,children:[e.jsx(K,{variant:"outline",startIcon:e.jsx(oe,{}),size:"xs",children:e.jsx(i,{message:"Views"})}),e.jsx(z,{onClick:o=>{o.target instanceof HTMLElement&&o.target.closest("button,a")&&s(!1)},children:e.jsx(le,{})})]})}function O(){return e.jsx(de,{size:"sm",image:e.jsx(ce,{size:"xl"}),imageMargin:"mb-12",imageHeight:"h-auto",title:e.jsx(i,{message:"There are no conversations in this view"})})}function P(){const t=_(),s=t?e.jsx(i,{message:t}):e.jsx(i,{message:"All"});return e.jsxs(m.Fragment,{children:[s,e.jsx(J,{children:s})]})}function ye(){const{conversationsTableViewsSidebarOpen:t,toggleConversationsTableViewsSidebar:s}=U();return e.jsx(F,{placement:"bottom",label:t?e.jsx(i,{message:"Hide views sidebar"}):e.jsx(i,{message:"Show views sidebar"}),children:e.jsx(G,{size:"xs",onClick:()=>s(),children:e.jsx(ue,{})})})}export{As as Component};
