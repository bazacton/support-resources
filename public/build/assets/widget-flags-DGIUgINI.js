import{bk as n}from"./client-OfhJa1Pp.js";import{g as v}from"./use-widget-bootstrap-data-BlKRRco5.js";const I={listen:(t,e)=>{const o=i=>{var s,r,a;if(i.data.source==="ai-agent-preview")switch(i.data.type){case"previewLoaded":(s=e.onPreviewLoaded)==null||s.call(e);break;case"conversationIdChanged":(r=e.onConversationIdChanged)==null||r.call(e,i.data.value);break;case"conversationReset":(a=e.onConversationReset)==null||a.call(e);break}};return t.addEventListener("message",o),()=>{t.removeEventListener("message",o)}},postConversationIdChanged:(t,e)=>{d(t,"conversationIdChanged",e)},postConversationReset:t=>{d(t,"conversationReset",null)},postLoaded:t=>{d(t,"previewLoaded",null)}};function d(t,e,o){t.postMessage({source:"ai-agent-preview",type:e,value:o},"*")}let g=null,w=null;const p=()=>{var o;n("X-Chat-Widget","true");const t=(o=v().aiAgent)==null?void 0:o.id;t?(g=`${t}`,n("X-Widget-Ai-Agent-Id",`${t}`)):g=null;const e=v().knowledgeScopeTag;e&&n("X-Widget-Knowledge-Scope-Tag",e)},C={setHeadersForLiveMode:p,setHeadersForPreviewMode:()=>{p(),n("X-Ai-Agent-Preview-Mode","true")},getAiAgentId:()=>g,getKnowledgeScopeTag:()=>w,keys:{url:{aiAgentId:"xWidgetAiAgentId",flowId:"xWidgetFlowId",isMobile:"xWidgetIsMobile"},headers:{widget:"X-Chat-Widget"}}};export{C as W,I as a};
