import{u as i,r as n,bn as f,x as b,ae as d,j as t,p as h}from"./client-OfhJa1Pp.js";import{F as w}from"./file-type-icon-Dok_AF4H.js";const x=n.createContext(null);function U(e,r){const{base_url:l}=i(),u=n.useContext(x);return n.useMemo(()=>{if(!e)return{};const a={previewUrl:g(e,(r==null?void 0:r.preferThumbnail)||!1),downloadUrl:`${l}/api/v1/file-entries/download/${(r==null?void 0:r.downloadHashes)||e.hash}`};return u&&(a.previewUrl&&(a.previewUrl=c(a.previewUrl,{...u,thumbnail:r!=null&&r.preferThumbnail?"true":""},l)),a.downloadUrl=c(a.downloadUrl,u,l)),a},[l,e,r==null?void 0:r.downloadHashes,r==null?void 0:r.preferThumbnail,u])}function g(e,r){if(e.url){if(f(e.url))if(r&&e.thumbnail){const l=e.extension==="png"?"png":"jpg";return e.url.replace(new RegExp(e.file_name+"$"),`thumbnail.${l}`)}else return e.url;return`${b().settings.base_url}/${e.url}`}}function c(e,r,l){const u=new URL(e,l);return Object.entries(r).forEach(([s,a])=>{u.searchParams.append(s,a)}),u.toString()}const v=2*1024*1024;function E({file:e,className:r,iconClassName:l,showImage:u=!0}){const{trans:s}=d(),{previewUrl:a}=U(e,{preferThumbnail:!0});if(e.file_size&&e.file_size>v&&!e.thumbnail&&(u=!1),u&&e.type==="image"&&a){const m=s({message:":fileName thumbnail",values:{fileName:e.name}});return t.jsx("img",{className:h(r,"object-cover"),src:a,alt:m,draggable:!1})}return t.jsx(w,{className:l,type:e.type})}export{x as F,E as a,U as u};
