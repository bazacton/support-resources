import{r as T,j as e,T as a,b1 as x,b2 as h,m as r,aZ as v,q as y,av as C,B as P,aX as d,L as b,H as k,aj as F,al as I,i as B,s as q,k as A,t as W}from"./client-OfhJa1Pp.js";import{g as p,h as _,i as H,j as L}from"./main-CqFMqK8-.js";import{t as z,S as E}from"./sync-tags-button-CBK7H6fR.js";import{o as N}from"./online-articles-CqWeBVNj.js";import{G as K}from"./global-loading-progress-CKXIm6JS.js";import{D as Q}from"./data-table-header-CeAVoFvI.js";import{D as V}from"./data-table-pagination-footer-CEEx1VtI.js";import{u as M}from"./use-datatable-search-params-CQGreY35.js";import{D as $}from"./data-table-emty-state-message-DLsG3g03.js";import{D as O}from"./datatable-filters-C2DdpqvR.js";import{a as R,D as G,b as X,c as Z}from"./datatable-page-with-header-layout-B1YkbSHJ.js";import{u as J}from"./use-datatable-query-BQ-GXlzU.js";import{u as f}from"./custom-menu-BbwshV9x.js";import{T as U}from"./table-BifRiqkr.js";import{B as Y,a as g}from"./breadcrumb-DMWJORWM.js";import{C as ee}from"./chip-list-CkGaRoaT.js";import{V as se}from"./Visibility-BkaRhH0o.js";import{C as ae}from"./confirmation-dialog-BIOq1A-h.js";import"./section-helper-Cq13cJUI.js";import"./form-chip-field-sH5S7-lx.js";import"./FilterAlt-CXibH0wr.js";import"./select-filter-panel-C_zo36WK.js";import"./filter-operator-names-BZog1mvA.js";import"./select-Dsco87dL.js";import"./combobox-end-adornment-CaH5Sr_u.js";import"./normalized-model-field-COxh0lBC.js";import"./Edit-JNj6SFDx.js";import"./skeleton-Cp2m1Uyc.js";import"./accordion-DWEV-mKU.js";import"./accordtion-animation-BGCK95Hj.js";import"./checkbox-C4s6ROxp.js";import"./CheckBoxOutlineBlank-DQZJM1Yc.js";import"./formatted-number-DuD1Sa1W.js";import"./use-toggle-dashboard-left-sidebar-CnzMOFB9.js";import"./toggle-left-sidebar-icon-Dq5ZwqwZ.js";import"./ArrowDownward-mN9PlQJw.js";import"./useEffectEvent-DQn3o5L0.js";import"./is-ctrl-key-pressed-BWsUhNJl.js";import"./useGlobalListeners-CeWFSHKo.js";import"./ChevronRight-T5gg5A4x.js";import"./MoreHoriz-hMMIYAbm.js";const te=[{key:"name",width:"flex-3 min-w-200",visibleInMode:"all",header:()=>e.jsx(a,{message:"Page"}),body:s=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-6",children:[!!s.tags.length&&e.jsx(ee,{size:"xs",children:s.tags.slice(0,3).map(t=>e.jsx(d,{children:t},t))}),e.jsx(b,{to:s.fully_scanned?`${s.id}`:"",className:"block hover:underline",children:s.title})]}),e.jsx("a",{href:s.url,target:"_blank",rel:"noreferrer",className:"text-xs text-muted hover:underline",children:s.url})]})},{key:"fully_scanned",allowsSorting:!0,width:"w-100 flex-shrink-0",header:()=>e.jsx(a,{message:"Status"}),body:s=>s.fully_scanned?s.scan_pending?e.jsx(d,{color:"primary",size:"xs",children:e.jsx(a,{message:"Sync pending"})}):e.jsx(d,{color:"positive",size:"xs",children:e.jsx(a,{message:"Synced"})}):e.jsx(d,{color:"danger",size:"xs",children:e.jsx(a,{message:"Scan pending"})})},{key:"updatedAt",allowsSorting:!0,width:"w-96",header:()=>e.jsx(a,{message:"Last updated"}),body:s=>e.jsx("time",{children:e.jsx(k,{date:s.updated_at})})},{key:"actions",header:()=>e.jsx(a,{message:"Actions"}),width:"w-42 flex-shrink-0",hideHeader:!0,align:"end",visibleInMode:"all",body:s=>e.jsx("div",{className:"text-muted",children:e.jsx(F,{size:"md",elementType:b,to:`${s.id}`,disabled:!s.fully_scanned,children:e.jsx(se,{})})})}],j=[{key:"fully_scanned",label:r("Fully scanned"),description:r("Whether webpage was fully scanned at least once"),defaultOperator:h.eq,control:{type:x.BooleanToggle,defaultValue:!0}},{key:"scan_pending",label:r("Scan pending"),description:r("Whether webpage is queued for scanning"),defaultOperator:h.eq,control:{type:x.BooleanToggle,defaultValue:!0}},z(),H({label:r("First scanned"),description:r("Date webpage was first scanned")}),L({description:r("Date webpage was last updated")})];function Oe(){var u;const[s,t]=T.useState([]),{websiteId:m}=f(["websiteId"]),{searchParams:n,sortDescriptor:l,mergeIntoSearchParams:i,setSearchQuery:w,isFiltering:D}=M(v),o=J(p.webpages.index(m,n)),S=e.jsxs(e.Fragment,{children:[e.jsx(E,{taggableType:"aiAgentWebpage",selectedIds:s,onTagsSynced:()=>{y.invalidateQueries({queryKey:p.webpages.invalidateKey}),t([])}}),e.jsxs(C,{type:"modal",children:[e.jsx(P,{variant:"flat",color:"danger",children:e.jsx(a,{message:"Delete"})}),e.jsx(re,{selectedIds:s,onDelete:()=>t([])})]})]});return e.jsxs(R,{children:[e.jsx(K,{query:o}),e.jsx(_,{children:e.jsx(a,{message:"Webpages"})}),e.jsx(G,{showSidebarToggleButton:!0,children:e.jsxs(Y,{size:"xl",children:[e.jsx(g,{to:"../knowledge",children:e.jsx(a,{message:"Knowledge"})}),e.jsx(g,{to:"../knowledge/websites",children:e.jsx(a,{message:"Websites"})}),e.jsx(g,{children:(u=o.data)==null?void 0:u.website.title})]})}),e.jsxs(X,{children:[e.jsx(Q,{searchValue:n.query,onSearchChange:w,filters:j,selectedItems:s,selectedActions:S}),e.jsx(O,{filters:j}),e.jsxs(Z,{children:[e.jsx(U,{columns:te,data:o.items,sortDescriptor:l,onSortChange:i,cellHeight:"h-64",selectedRows:s,onSelectionChange:t}),o.isEmpty?e.jsx($,{image:N,isFiltering:D,title:e.jsx(a,{message:"No webpages have been scanned yet"}),filteringTitle:e.jsx(a,{message:"No matching webpages"})}):null,e.jsx(V,{query:o,onPageChange:c=>i({page:c}),onPerPageChange:c=>i({perPage:c})})]})]})]})}function re({selectedIds:s,onDelete:t}){const{websiteId:m}=f(["websiteId"]),{close:n}=I(),l=B({mutationFn:()=>A.delete(`lc/ai-agent/websites/${m}/webpages/${s.join(",")}`),onSuccess:async()=>{await y.invalidateQueries({queryKey:p.knowledge.invalidateKey}),W(r("Webpages deleted")),t(),n()},onError:i=>q(i)});return e.jsx(ae,{isDanger:!0,isLoading:l.isPending,title:e.jsx(a,{message:"Delete webpages"}),body:e.jsx(a,{message:"Are you sure you want to delete selected webpages?",values:{count:s.length}}),confirm:e.jsx(a,{message:"Delete"}),onConfirm:()=>l.mutate()})}export{Oe as Component};
