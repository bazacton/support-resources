import{r as y,_ as T,i as k,s as A,m as r,q as f,t as P,k as _,j as e,av as B,B as S,T as s,al as N,bZ as R,b1 as p,b2 as g,aZ as z,L as u,aX as m,aQ as D,as as w,H as E,aj as F,aw as q,ag as H,ax as Q,az as x}from"./client-OfhJa1Pp.js";import{g as h,h as K,i as L}from"./main-CqFMqK8-.js";import{u as M,a as $}from"./use-ingest-snippets-BU6EPthB.js";import{t as O,S as V}from"./sync-tags-button-CBK7H6fR.js";import{o as W}from"./online-articles-CqWeBVNj.js";import{G}from"./global-loading-progress-CKXIm6JS.js";import{D as U}from"./data-table-add-item-button-2jwTYQ5G.js";import{D as Z}from"./data-table-header-CeAVoFvI.js";import{D as X}from"./data-table-pagination-footer-CEEx1VtI.js";import{u as Y}from"./use-datatable-search-params-CQGreY35.js";import{D as J}from"./data-table-emty-state-message-DLsG3g03.js";import{D as ee}from"./datatable-filters-C2DdpqvR.js";import{a as te,D as se,b as ae,c as ne}from"./datatable-page-with-header-layout-B1YkbSHJ.js";import{C as ie}from"./confirmation-dialog-BIOq1A-h.js";import{D as re}from"./paginated-resources-BrzANtLm.js";import{u as oe}from"./use-datatable-query-BQ-GXlzU.js";import{u as le}from"./custom-menu-BbwshV9x.js";import{T as de}from"./table-BifRiqkr.js";import{B as ce,a as j}from"./breadcrumb-DMWJORWM.js";import{C as me}from"./chip-list-CkGaRoaT.js";import{E as ue}from"./Edit-JNj6SFDx.js";import"./section-helper-Cq13cJUI.js";import"./form-chip-field-sH5S7-lx.js";import"./Add-CN0r1QLK.js";import"./FilterAlt-CXibH0wr.js";import"./select-filter-panel-C_zo36WK.js";import"./filter-operator-names-BZog1mvA.js";import"./select-Dsco87dL.js";import"./combobox-end-adornment-CaH5Sr_u.js";import"./normalized-model-field-COxh0lBC.js";import"./skeleton-Cp2m1Uyc.js";import"./accordion-DWEV-mKU.js";import"./accordtion-animation-BGCK95Hj.js";import"./checkbox-C4s6ROxp.js";import"./CheckBoxOutlineBlank-DQZJM1Yc.js";import"./formatted-number-DuD1Sa1W.js";import"./use-toggle-dashboard-left-sidebar-CnzMOFB9.js";import"./toggle-left-sidebar-icon-Dq5ZwqwZ.js";import"./ArrowDownward-mN9PlQJw.js";import"./useEffectEvent-DQn3o5L0.js";import"./is-ctrl-key-pressed-BWsUhNJl.js";import"./useGlobalListeners-CeWFSHKo.js";import"./ChevronRight-T5gg5A4x.js";import"./MoreHoriz-hMMIYAbm.js";const pe=T.createContext(null);function I(){return y.useContext(pe)}function ge(){const{endpoint:t,selectedRows:a,setSelectedRows:n,baseQueryKey:i}=I();return k({mutationFn:()=>xe(t,a),onSuccess:async()=>{await f.invalidateQueries({queryKey:re(t,void 0,i)}),P(r("Deleted [one 1 record|other :count records]",{values:{count:a.length}})),n([])},onError:o=>A(o,r("Could not delete records"))})}function xe(t,a){return _.delete(`${t}/${a.join(",")}`).then(n=>n.data)}function he(){return e.jsxs(B,{type:"modal",children:[e.jsx(S,{variant:"flat",color:"danger",className:"ml-auto",children:e.jsx(s,{message:"Delete"})}),e.jsx(je,{})]})}function je(){const t=ge(),{selectedRows:a,setSelectedRows:n}=I(),{close:i}=N();return e.jsx(ie,{isLoading:t.isPending,title:e.jsx(s,{message:"Delete [one 1 item|other :count items]?",values:{count:a.length}}),body:e.jsx(s,{message:"This will permanently remove the items and cannot be undone."}),confirm:e.jsx(s,{message:"Delete"}),isDanger:!0,onConfirm:()=>{t.mutate(void 0,{onSuccess:()=>i(),onError:o=>{R(o,422)&&(n([]),i())}})}})}const be=[{key:"name",width:"flex-3 min-w-200",visibleInMode:"all",header:()=>e.jsx(s,{message:"Title"}),body:t=>e.jsxs("div",{className:"flex items-center gap-6",children:[!!t.tags.length&&e.jsx(me,{size:"xs",children:t.tags.slice(0,3).map(a=>e.jsx(m,{children:a},a))}),e.jsx(u,{to:`../knowledge/snippets/${t.id}/edit`,className:"hover:underline",children:t.title})]})},{key:"fully_scanned",allowsSorting:!0,width:"w-144 flex-shrink-0",header:()=>e.jsx(s,{message:"Status"}),body:t=>t.scan_pending?e.jsx(m,{color:"danger",size:"xs",children:e.jsx(s,{message:"Scan pending"})}):e.jsx(m,{color:"positive",size:"xs",children:e.jsx(s,{message:"Scanned"})})},{key:"used_by_ai_agent",allowsSorting:!0,width:"w-100 flex-shrink-0",header:()=>e.jsx(s,{message:"AI agent"}),body:t=>t.used_by_ai_agent?e.jsx(D,{size:"md",className:"text-positive"}):e.jsx(w,{size:"md",className:"text-muted"})},{key:"created_at",allowsSorting:!0,width:"w-144",header:()=>e.jsx(s,{message:"Scan date"}),body:t=>e.jsx("time",{children:e.jsx(E,{date:t.created_at})})},{key:"actions",header:()=>e.jsx(s,{message:"Actions"}),width:"w-42 flex-shrink-0",hideHeader:!0,align:"end",visibleInMode:"all",body:t=>e.jsx("div",{className:"text-muted",children:e.jsx(F,{size:"md",elementType:u,to:`../knowledge/snippets/${t.id}/edit`,disabled:t.scan_pending,children:e.jsx(ue,{})})})}],b=[{key:"scan_pending",label:r("Fully scanned"),description:r("Whether snippet is fully scanned"),defaultOperator:g.eq,control:{type:p.Select,defaultValue:"0",options:[{value:!0,label:"No",key:"1"},{value:!1,label:"Yes",key:"0"}]}},{key:"used_by_ai_agent",label:r("AI Agent status"),defaultOperator:g.eq,control:{type:p.Select,options:[{key:"01",value:!0,label:r("Used by AI agent")},{key:"02",value:!1,label:r("Not used by AI agent")}],defaultValue:"01"}},O(),L({label:r("Creation date"),description:r("Date snippet was created")})];function ut(){const{aiAgentId:t}=le(["aiAgentId"]),[a,n]=y.useState([]),{searchParams:i,sortDescriptor:o,mergeIntoSearchParams:d,setSearchQuery:v,isFiltering:C}=Y(z),l=oe(h.snippets.index(t,i));return e.jsxs(te,{children:[e.jsx(G,{query:l}),e.jsx(K,{children:e.jsx(s,{message:"Snippets"})}),e.jsx(se,{showSidebarToggleButton:!0,children:e.jsxs(ce,{size:"xl",children:[e.jsx(j,{to:"../knowledge",children:e.jsx(s,{message:"Knowledge"})}),e.jsx(j,{to:"../knowledge/snippets",children:e.jsx(s,{message:"Snippets"})})]})}),e.jsxs(ae,{children:[e.jsx(Z,{searchValue:i.query,onSearchChange:v,filters:b,actions:e.jsx(ye,{}),selectedItems:a,selectedActions:e.jsx(fe,{selectedIds:a,onActionDone:()=>{f.invalidateQueries({queryKey:h.snippets.invalidateKey}),n([])}})}),e.jsx(ee,{filters:b}),e.jsxs(ne,{children:[e.jsx(de,{columns:be,data:l.items,enableSelection:!0,selectedRows:a,onSelectionChange:n,sortDescriptor:o,onSortChange:d,cellHeight:"h-64"}),l.isEmpty?e.jsx(J,{isFiltering:C,image:W,title:e.jsx(s,{message:"No snippets have been created yet"}),filteringTitle:e.jsx(s,{message:"No matching snippets"})}):null,e.jsx(X,{query:l,onPageChange:c=>d({page:c}),onPerPageChange:c=>d({perPage:c})})]})]})]})}function ye(){return e.jsx(U,{elementType:u,to:"new",children:e.jsx(s,{message:"Add snippet"})})}function fe({selectedIds:t,onActionDone:a}){return e.jsxs("div",{className:"flex gap-8",children:[e.jsx(Se,{selectedIds:t,onActionDone:a}),e.jsx(V,{taggableType:"aiAgentSnippet",selectedIds:t,onTagsSynced:()=>a()}),e.jsx(he,{})]})}function Se({selectedIds:t,onActionDone:a}){const n=M(),i=$();return e.jsxs(q,{children:[e.jsx(S,{variant:"outline",endIcon:e.jsx(H,{}),disabled:n.isPending||i.isPending,children:e.jsx(s,{message:"Change AI agent state"})}),e.jsxs(Q,{children:[e.jsx(x,{value:"enable",startIcon:e.jsx(D,{size:"sm"}),onSelected:()=>n.mutate({snippetIds:t},{onSuccess:()=>a()}),children:e.jsx(s,{message:"Enable for AI agent"})}),e.jsx(x,{value:"disable",startIcon:e.jsx(w,{size:"sm"}),onSelected:()=>i.mutate({snippetIds:t},{onSuccess:()=>a()}),children:e.jsx(s,{message:"Disable for AI agent"})})]})]})}export{ut as Component};
