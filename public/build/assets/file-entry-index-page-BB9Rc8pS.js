import{m as a,b1 as d,b2 as p,r as u,aZ as b,j as e,T as s,av as h,B as j,aQ as w,as as v,H as D,aj as k,al as S,i as F,s as T,k as E,q as P,t as C}from"./client-OfhJa1Pp.js";import{A as I}from"./admin-config-tfY5n3F7.js";import{i as N,j as _,y as A,c as f}from"./main-CqFMqK8-.js";import{D as L}from"./settings-links-D22SAe6v.js";import{G as q}from"./global-loading-progress-CKXIm6JS.js";import{D as R}from"./data-table-header-CeAVoFvI.js";import{D as V}from"./data-table-pagination-footer-CEEx1VtI.js";import{u as B}from"./use-datatable-search-params-CQGreY35.js";import{D as H}from"./datatable-filters-C2DdpqvR.js";import{a as U,D as z,b as M,c as W}from"./datatable-page-with-header-layout-B1YkbSHJ.js";import{u as O}from"./use-datatable-query-BQ-GXlzU.js";import{T as Q}from"./table-BifRiqkr.js";import{F as G}from"./file-preview-dialog-DZbR1Zhl.js";import{F as K}from"./file-type-icon-Dok_AF4H.js";import{F as Y}from"./formatted-bytes-CmuQhzYn.js";import{V as X}from"./Visibility-BkaRhH0o.js";import{C as Z}from"./confirmation-dialog-BIOq1A-h.js";import{a as $}from"./name-with-avatar-DcHWBlN8.js";import{D as J}from"./data-table-emty-state-message-DLsG3g03.js";import"./dashboard-icons-CHop3mns.js";import"./library-icon-CHCHM-UW.js";import"./messages-square-icon-CTmom_u4.js";import"./Delete-BhyMZiPM.js";import"./Home--R_oEr6a.js";import"./SupervisorAccount-k9OnPB-d.js";import"./Translate-Cs-ut2nW.js";import"./TextFields-8TfbEP0O.js";import"./custom-menu-BbwshV9x.js";import"./external-link-DbBk1ItZ.js";import"./book-open-Cbdc52Ur.js";import"./FilterAlt-CXibH0wr.js";import"./select-filter-panel-C_zo36WK.js";import"./form-chip-field-sH5S7-lx.js";import"./chip-list-CkGaRoaT.js";import"./filter-operator-names-BZog1mvA.js";import"./select-Dsco87dL.js";import"./combobox-end-adornment-CaH5Sr_u.js";import"./normalized-model-field-COxh0lBC.js";import"./Edit-JNj6SFDx.js";import"./skeleton-Cp2m1Uyc.js";import"./accordion-DWEV-mKU.js";import"./accordtion-animation-BGCK95Hj.js";import"./checkbox-C4s6ROxp.js";import"./CheckBoxOutlineBlank-DQZJM1Yc.js";import"./formatted-number-DuD1Sa1W.js";import"./use-toggle-dashboard-left-sidebar-CnzMOFB9.js";import"./toggle-left-sidebar-icon-Dq5ZwqwZ.js";import"./ArrowDownward-mN9PlQJw.js";import"./useEffectEvent-DQn3o5L0.js";import"./is-ctrl-key-pressed-BWsUhNJl.js";import"./useGlobalListeners-CeWFSHKo.js";import"./file-thumbnail-D9-TxWtC.js";import"./ChevronLeft-B96ua4ZU.js";import"./ChevronRight-T5gg5A4x.js";import"./FileDownload-DoJWzr8l.js";import"./download-file-from-url-hJ3EUwXO.js";import"./pretty-bytes-bO14ePu9.js";const ee={key:"type",label:a("Type"),description:a("Type of the file"),defaultOperator:p.eq,control:{type:d.Select,defaultValue:"05",options:[{key:"02",label:a("Text"),value:"text"},{key:"03",label:a("Audio"),value:"audio"},{key:"04",label:a("Video"),value:"video"},{key:"05",label:a("Image"),value:"image"},{key:"06",label:a("PDF"),value:"pdf"},{key:"07",label:a("Spreadsheet"),value:"spreadsheet"},{key:"08",label:a("Word Document"),value:"word"},{key:"09",label:a("Photoshop"),value:"photoshop"},{key:"10",label:a("Archive"),value:"archive"},{key:"11",label:a("Folder"),value:"folder"}]}},c=[ee,{key:"public",label:a("Visibility"),description:a("Whether file is publicly accessible"),defaultOperator:p.eq,control:{type:d.Select,defaultValue:"01",options:[{key:"01",label:a("Private"),value:!1},{key:"02",label:a("Public"),value:!0}]}},N({description:a("Date file was uploaded")}),_({description:a("Date file was last changed")}),{key:"owner_id",label:a("Uploader"),description:a("User that this file was uploaded by"),defaultOperator:p.eq,control:{type:d.SelectModel,model:A}}],te=""+new URL("upload-DtVE1GoK.svg",import.meta.url).href,ae=[{key:"name",allowsSorting:!0,visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(s,{message:"Name"}),body:t=>e.jsxs(u.Fragment,{children:[e.jsx("div",{className:"overflow-x-hidden overflow-ellipsis",children:t.name}),e.jsx("div",{className:"overflow-x-hidden overflow-ellipsis text-xs text-muted",children:t.file_name})]})},{key:"owner_id",allowsSorting:!0,width:"flex-3 min-w-200",header:()=>e.jsx(s,{message:"Uploader"}),body:t=>{var o,r;const i=((o=t.users)==null?void 0:o.find(l=>l.owns_entry))??((r=t.users)==null?void 0:r[0]);return i?e.jsx($,{image:i.image,label:i.name,description:i.email}):null}},{key:"type",width:"w-100 flex-shrink-0",allowsSorting:!0,header:()=>e.jsx(s,{message:"Type"}),body:t=>e.jsxs("div",{className:"flex items-center gap-12",children:[e.jsx(K,{type:t.type,className:"h-24 w-24 overflow-hidden"}),e.jsx("div",{className:"capitalize",children:t.type})]})},{key:"public",allowsSorting:!0,width:"w-60 flex-shrink-0",header:()=>e.jsx(s,{message:"Public"}),body:t=>t.public?e.jsx(w,{className:"text-positive icon-md"}):e.jsx(v,{className:"text-danger icon-md"})},{key:"file_size",allowsSorting:!0,maxWidth:"max-w-100",header:()=>e.jsx(s,{message:"File size"}),body:t=>e.jsx(Y,{bytes:t.file_size})},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>e.jsx(s,{message:"Last updated"}),body:t=>e.jsx(D,{date:t.updated_at})},{key:"actions",header:()=>e.jsx(s,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:t=>e.jsxs(h,{type:"modal",children:[e.jsx(k,{size:"md",className:"text-muted",children:e.jsx(X,{})}),e.jsx(G,{entries:[t]})]})}];function lt(){const[t,i]=u.useState([]),{searchParams:o,sortDescriptor:r,mergeIntoSearchParams:l,setSearchQuery:g,isFiltering:x}=B(b),n=O(f.fileEntries.index(o)),y=e.jsxs(h,{type:"modal",children:[e.jsx(j,{variant:"flat",color:"danger",children:e.jsx(s,{message:"Delete"})}),e.jsx(se,{selectedIds:t,onDelete:()=>i([])})]});return e.jsxs(U,{children:[e.jsx(q,{query:n}),e.jsx(z,{title:e.jsx(s,{message:"Uploaded files and folders"}),showSidebarToggleButton:!0,rightContent:e.jsx(L,{variant:"button",link:I.pages.files,size:"xs"})}),e.jsxs(M,{children:[e.jsx(R,{searchValue:o.query,onSearchChange:g,selectedItems:t,selectedActions:y,filters:c}),e.jsx(H,{filters:c}),e.jsxs(W,{children:[e.jsx(Q,{columns:ae,data:n.items,sortDescriptor:r,onSortChange:l,enableSelection:!0,selectedRows:t,onSelectionChange:i}),n.isEmpty&&e.jsx(J,{isFiltering:x,image:te,title:e.jsx(s,{message:"Nothing has been uploaded yet"}),filteringTitle:e.jsx(s,{message:"No matching files or folders"})}),e.jsx(V,{query:n,onPageChange:m=>l({page:m}),onPerPageChange:m=>l({perPage:m})})]})]})]})}function se({selectedIds:t,onDelete:i}){const{close:o}=S(),r=F({mutationFn:()=>E.delete(`file-entries/${t.join(",")}`),onSuccess:async()=>{await P.invalidateQueries({queryKey:f.fileEntries.invalidateKey}),C(a("File entries deleted")),i(),o()},onError:l=>T(l)});return e.jsx(Z,{isDanger:!0,isLoading:r.isPending,title:e.jsx(s,{message:"Delete file entries"}),body:e.jsx(s,{message:"Are you sure you want to delete selected file entries?",values:{count:t.length}}),confirm:e.jsx(s,{message:"Delete"}),onConfirm:()=>r.mutate()})}export{lt as Component};
