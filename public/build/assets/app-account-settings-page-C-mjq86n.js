import{i as l,q as u,l as m,t as p,m as x,k as h,d as g,al as j,j as e,am as v,an as f,T as t,ap as P,aP as y,F as b,aq as C,B as i,Z as S,r as F,av as I,p as w,H as A,P as N,u as E}from"./client-OfhJa1Pp.js";import{o as D,I as k}from"./custom-menu-BbwshV9x.js";import{u as T}from"./use-sync-envato-purchases-BudvWHKl.js";import{A as _,b as B}from"./account-settings-sidenav-vZbwVhm-.js";import{J as M}from"./main-CqFMqK8-.js";import{E as d}from"./envato-DBGzmVaf.js";import{AccountSettingsPage as Q}from"./account-settings-page-BnJba6gp.js";import"./use-all-social-logins-disabled-BMKvG5Ea.js";import"./PhonelinkLock-C7x0YnbT.js";import"./Lock-CrI8g69F.js";import"./Login-D6kg4ucG.js";import"./two-factor-panel-4xntbDPG.js";import"./Tablet-Oq_GwDxE.js";import"./google-Dd-KeGPQ.js";import"./use-social-login-b3ri8mei.js";import"./skeleton-Cp2m1Uyc.js";import"./access-token-panel-DaMFTxVE.js";import"./external-link-DbBk1ItZ.js";import"./confirmation-dialog-BIOq1A-h.js";import"./use-clipboard-DVaYjxFN.js";import"./image-selector-Bwr5VwEQ.js";import"./file-upload-provider-DTPBUrkd.js";import"./uploaded-file-DN6fXT4v.js";import"./pretty-bytes-bO14ePu9.js";import"./with-selector-CDgEpx5P.js";import"./use-active-upload-CCDRf1Tl.js";import"./open-upload-window-CSDcieK1.js";import"./shallow-BSWIanyL.js";import"./AddAPhoto-eWqbbo4Z.js";import"./progress-bar-iRLStr1h.js";import"./file-input-config-DrcTpI3-.js";import"./AlternateEmail-DjCOtnvc.js";import"./update-account-details-UjZzNeIq.js";import"./localization-panel-CeSpid2E.js";import"./combobox-pHOmOE77.js";import"./combobox-end-adornment-CaH5Sr_u.js";import"./select-Dsco87dL.js";function H(r){return l({mutationFn:s=>q(s),onSuccess:async()=>{await u.invalidateQueries({queryKey:m.envato.invalidateKey}),p(x("Purchase added"))},onError:s=>D(s,r)})}function q(r){return h.post(`users/${r.userId}/envato/add-purchase-using-code`,r).then(s=>s.data)}function K({userId:r}){const s=g(),a=H(s),{close:o,formId:n}=j();return e.jsxs(v,{children:[e.jsx(f,{children:e.jsx(t,{message:"Add purchase code"})}),e.jsx(P,{children:e.jsx(y,{id:n,form:s,onSubmit:c=>a.mutate({userId:r,purchaseCode:c.purchaseCode},{onSuccess:()=>o()}),children:e.jsx(b,{name:"purchaseCode",label:e.jsx(t,{message:"Purchase code"}),autoFocus:!0})})}),e.jsxs(C,{children:[e.jsx(i,{variant:"outline",onClick:()=>o(),children:e.jsx(t,{message:"Close"})}),e.jsx(i,{variant:"flat",color:"primary",type:"submit",form:n,disabled:a.isPending,children:e.jsx(t,{message:"Add"})})]})]})}function Y({user:r}){const s=S(m.envato.userPurchases(r.id)),a=T();return e.jsx(_,{id:"purchases",title:e.jsx(t,{message:"Your purchases"}),actions:e.jsxs(F.Fragment,{children:[e.jsxs(I,{type:"modal",children:[e.jsx(i,{variant:"outline",className:"mr-12",children:e.jsx(t,{message:"Add purchase code"})}),e.jsx(K,{userId:"me"})]}),e.jsx(i,{variant:"flat",color:"primary",onClick:()=>a.mutate({userId:"me"}),disabled:a.isPending,children:e.jsx(t,{message:"Import purchases from envato"})})]}),children:e.jsx(z,{query:s})})}function z({query:r}){return r.data?r.data.purchases.length?e.jsx("div",{children:r.data.purchases.map(s=>e.jsxs("div",{className:"relative flex items-center gap-12 rounded py-10 hover:bg-hover",children:[e.jsx("img",{src:s.image,alt:"",className:"h-64 w-64 rounded"}),e.jsxs("div",{className:"min-w-0 text-sm",children:[e.jsxs("a",{href:s.url,target:"_blank",rel:"noreferrer",className:"overflow-hidden overflow-ellipsis whitespace-nowrap font-semibold",children:[e.jsx("span",{className:"absolute inset-0 rounded"}),s.item_name]}),e.jsx("div",{className:"my-4 text-xs",children:e.jsx(t,{message:"Purchase code: :code",values:{code:s.code}})}),e.jsx("div",{className:w("text-xs text-muted",s.support_expired&&"line-through"),children:s.supported_until?e.jsxs("span",{children:[e.jsx(t,{message:"Supported until:"})," ",e.jsx(A,{date:s.supported_until})]}):e.jsx(t,{message:"Support expired"})})]})]},s.id))}):e.jsx("div",{children:e.jsx(k,{size:"sm",imageHeight:"h-auto",title:e.jsx(t,{message:"Could not find any purchases"}),description:e.jsx(t,{message:"Try importing purchases from envato with the button below."}),imageMargin:"mb-10",image:e.jsx("div",{children:e.jsx(d,{viewBox:"0 0 50 50",className:"text-envato"})})})}):r.isLoading?e.jsx("div",{className:"flex min-h-82 items-center justify-center",children:e.jsx(N,{isIndeterminate:!0})}):e.jsx(M,{})}function Ie(){const{envato:r}=E(),s=r==null?void 0:r.enable;return e.jsx(Q,{panels:s?a=>e.jsx(Y,{user:a}):void 0,sidenavItems:s?e.jsx(B,{icon:e.jsx(d,{}),panel:"purchases",children:e.jsx(t,{message:"Your purchases"})}):null})}export{Ie as Component};
